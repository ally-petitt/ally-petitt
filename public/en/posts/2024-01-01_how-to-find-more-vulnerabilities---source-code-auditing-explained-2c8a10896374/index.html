<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/ally-petitt/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=ally-petitt/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How to Find more Vulnerabilities — Source Code Auditing Explained | Ally Petitt</title>
<meta name="keywords" content="Tutorial, Security Research, Static Analysis">
<meta name="description" content="https://images.pexels.com/photos/374559/pexels-photo-374559.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1
Introduction Whitebox penetration testing can be intimidating. Complex web applications may contain hundreds of thousands of lines of code and deciphering the connection between the various web components and their numerous implementations is challenging. A powerful, yet simple technique to approach the code review of such an application is to break it into manageable pieces.
In this article, I will be outlining a methodology that can be used to break down large web applications, such as Content Management Systems (CMSs) into manageable components that can be systematically analyzed for vulnerabilities or logic errors.">
<meta name="author" content="Ally Petitt">
<link rel="canonical" href="https://ally-petitt.github.io/ally-petitt/en/en/posts/2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374/">
<link crossorigin="anonymous" href="/ally-petitt/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://ally-petitt.github.io/ally-petitt/en/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ally-petitt.github.io/ally-petitt/en/assets/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ally-petitt.github.io/ally-petitt/en/assets/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ally-petitt.github.io/ally-petitt/en/assets/apple-touch-icon.png">
<link rel="mask-icon" href="https://ally-petitt.github.io/ally-petitt/en/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://ally-petitt.github.io/ally-petitt/en/en/posts/2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
  

<meta property="og:title" content="How to Find more Vulnerabilities — Source Code Auditing Explained" />
<meta property="og:description" content="https://images.pexels.com/photos/374559/pexels-photo-374559.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1
Introduction Whitebox penetration testing can be intimidating. Complex web applications may contain hundreds of thousands of lines of code and deciphering the connection between the various web components and their numerous implementations is challenging. A powerful, yet simple technique to approach the code review of such an application is to break it into manageable pieces.
In this article, I will be outlining a methodology that can be used to break down large web applications, such as Content Management Systems (CMSs) into manageable components that can be systematically analyzed for vulnerabilities or logic errors." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ally-petitt.github.io/ally-petitt/en/en/posts/2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-01-01T00:00:00+00:00" /><meta property="og:site_name" content="Ally Petitt" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to Find more Vulnerabilities — Source Code Auditing Explained"/>
<meta name="twitter:description" content="https://images.pexels.com/photos/374559/pexels-photo-374559.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1
Introduction Whitebox penetration testing can be intimidating. Complex web applications may contain hundreds of thousands of lines of code and deciphering the connection between the various web components and their numerous implementations is challenging. A powerful, yet simple technique to approach the code review of such an application is to break it into manageable pieces.
In this article, I will be outlining a methodology that can be used to break down large web applications, such as Content Management Systems (CMSs) into manageable components that can be systematically analyzed for vulnerabilities or logic errors."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://ally-petitt.github.io/ally-petitt/en/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "How to Find more Vulnerabilities — Source Code Auditing Explained",
      "item": "https://ally-petitt.github.io/ally-petitt/en/en/posts/2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How to Find more Vulnerabilities — Source Code Auditing Explained",
  "name": "How to Find more Vulnerabilities — Source Code Auditing Explained",
  "description": "https://images.pexels.com/photos/374559/pexels-photo-374559.jpeg?auto=compress\u0026amp;cs=tinysrgb\u0026amp;w=1260\u0026amp;h=750\u0026amp;dpr=1\nIntroduction Whitebox penetration testing can be intimidating. Complex web applications may contain hundreds of thousands of lines of code and deciphering the connection between the various web components and their numerous implementations is challenging. A powerful, yet simple technique to approach the code review of such an application is to break it into manageable pieces.\nIn this article, I will be outlining a methodology that can be used to break down large web applications, such as Content Management Systems (CMSs) into manageable components that can be systematically analyzed for vulnerabilities or logic errors.",
  "keywords": [
    "Tutorial", "Security Research", "Static Analysis"
  ],
  "articleBody": " https://images.pexels.com/photos/374559/pexels-photo-374559.jpeg?auto=compress\u0026cs=tinysrgb\u0026w=1260\u0026h=750\u0026dpr=1\nIntroduction Whitebox penetration testing can be intimidating. Complex web applications may contain hundreds of thousands of lines of code and deciphering the connection between the various web components and their numerous implementations is challenging. A powerful, yet simple technique to approach the code review of such an application is to break it into manageable pieces.\nIn this article, I will be outlining a methodology that can be used to break down large web applications, such as Content Management Systems (CMSs) into manageable components that can be systematically analyzed for vulnerabilities or logic errors. This is the approach that I used to discover CVE-2023–43154 and it is the approach taught in the AWAE, OffSec’s prerequisite course to the OffSec Web Expert (OSWE) certification.\nNote that this article has an emphasis on web security, but the methodology can be applied to other fields of research as well.\nLet’s begin.\nMethodology At a high level, this methodology begins with gaining familiarity with the application as a whole. This phase includes\nIdentifying the technology stack — programming language, templating engine, database, etc.. Mapping out the application to gain a high-level overview of the structure of the project — commands like tree -L 3 may be used. Reading documentation Understanding common use cases of the application Exploring the application through its interface These steps help to develop a holistic understanding of the application. This enables you to better relate your subsequent findings to how the application is used, aiding in a more accurate assessment of impact and the likelihood of a successful exploit.\nThen, the approach can branch into either of two directions: bottom-up or top-down. To understand what this means, it is first important to define what is meant by a “source” and a “sink”. From there, it will become more clear what is meant by the aforementioned approaches.\nSources and Sinks Vulnerabilities in web applications commonly arise from the manner in which user input is handled. The entry point for user input is referred to as a source. An example of this would be input from a form, a query parameter in the URL, or a cookie. These are sources of user input that are then interpreted and handled by the web application.\nA sink, on the contrary, is where the user input is actually used. This is where the vulnerability occurs. In the case of a SQL injection, the source may be a query parameter that has contents concatenated with a SQL query.\nTo further illustrate this point, I will provide an example. The vulnerable PHP code below has a source, comment , and a sink, \u003c?php echo $_GET[‘comment’]; ?\u003e. The lack of sanitization on the PHP code as it echos the user input results in an XSS vulnerability.\n\u003c?php echo $\\_GET['comment']; ?\u003e For a more visual explanation, this LiveOverflow video provides an excellent demonstration of the topic.\nBottom-Up Approach The bottom-up approach refers to first locating sinks and tracing the code “upwards” to the source. For instance, I may search the code base for all occurrences of the sink system(), and from there follow the value that is passed into the function to search for any user input that may be implemented into that parameter.\nRegular expressions are a common technique to speed up the process of finding sinks. Patterns such as ^.*unserialize\\(.+\\) may be used to locate specific sinks (in this case, the unserialize() function) with more accuracy and can be used to narrow down the search effort. It is important to note, however, that this method has limitations. The regex results are only as strong as the pattern used and even well-established regular expressions can miss vulnerabilities and sinks.\nThis method is generally more tedious since not all occurrences of a sink will be used in the context of user-controlled data. Therefore, there can be more code to parse through in order to find a bug. Despite its repetitiveness, this approach has the advantage of increasing the likelihood of finding higher severity and less accessible vulnerabilities that are very difficult, if not impossible, to discover without access to the source code.\nTop-Down Approach On the contrary, the top-down approach consists of identifying sources and following their implementation in the code until a sink is found. For instance, I may submit the string “test” into a EditProfile functionality on a website. A top-down approach would consist of finding where the “test” string is received in the code and following the logic used on it until I locate its sink, or implementation, in a SQL query.\nRegular expressions can be used here as well. A basic example is ^.*?query to find query parameters. Regular expressions will typically become more complex depending on the specific context and the vulnerabilities that they are searching for.\nThis approach excels in finding vulnerabilities that are more accessible, but typically less severe. To clarify, high severity and high accessibility vulnerabilities can be discovered through either approach. One approach will simply increase your likelihood of finding a particular kind of vulnerability and the one that is chosen will depend on the individual priorities of the code review.\nFunctionality-Based Approach A different perspective on code review is breaking the application down into sections based on functionality. Instead of starting broad with all of the application’s sources or sinks and then narrowing down into a vulnerable one, this approach involves starting narrow with one functionality and learning how it works on a deeper level in order to search for vulnerabilities in that particular segment of the application.\nThis approach is particularly useful when prioritizing certain types of vulnerabilities based on factors such as required authentication level. In this instance, one can curate a list of functionalities that can be used without authentication and analyze those for vulnerabilities. Prioritization is a useful tool when auditing large code bases to increase the chances of finding higher severity vulnerabilities or medium-low severity vulnerabilities that can more elegantly be chained together to result in a higher-severity attack.\nTooling I previously mentioned that searching through the code with regular expressions can be used to quickly identify sources and sinks. In addition to this, tools such as Semgrep can also be used to grep for certain patterns in the code. Semgrep looks at the code as more than a text file. It develops and abstract syntax tree (AST) in order to better understand the semantics. This can lead to its recognition of a certain vulnerable pattern in code that a regex pattern would miss. On the other hand, both are only as strong as the way they were written and they can lead to many false positives.\nStatic Application Security Testing (SAST) solutions can also aide in identifying vulnerabilities. SpectralOps, Checkmarx, and Veracode are all examples of SAST tools used by organizations. I have not tried any of these at the time of writing, so I can not recommend one with certainty. SAST tools are generally meant for use by developers in the CI/CD pipeline, but they can also be used by researchers.\nConclusion The approach to static analysis that you use will impact the types of vulnerabilities that you are more likely and their likelihood of being exploitable. I encourage you to experiment with different approaches to static analysis and decide for yourself which methods work best for your goals. A mixed approach is quite common and even encouraged for best results.\nHappy hacking!\n",
  "wordCount" : "1241",
  "inLanguage": "en",
  "datePublished": "2024-01-01T00:00:00Z",
  "dateModified": "2024-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Ally Petitt"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ally-petitt.github.io/ally-petitt/en/en/posts/2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ally Petitt",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ally-petitt.github.io/ally-petitt/en/assets/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ally-petitt.github.io/ally-petitt/en/en/" accesskey="h" title="Home (Alt + H)">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ally-petitt.github.io/ally-petitt/en/en/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://ally-petitt.github.io/ally-petitt/en/en/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://ally-petitt.github.io/ally-petitt/en/en/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://ally-petitt.github.io/ally-petitt/en/en/about-me/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://ally-petitt.github.io/ally-petitt/en/en/">Home</a>&nbsp;»&nbsp;<a href="https://ally-petitt.github.io/ally-petitt/en/en/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      How to Find more Vulnerabilities — Source Code Auditing Explained
    </h1>
    <div class="post-meta"><span title='2024-01-01 00:00:00 +0000 UTC'>2024-01-01</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Ally Petitt

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#methodology" aria-label="Methodology">Methodology</a><ul>
                        
                <li>
                    <a href="#sources-andsinks" aria-label="Sources and Sinks">Sources and Sinks</a></li>
                <li>
                    <a href="#bottom-up-approach" aria-label="Bottom-Up Approach">Bottom-Up Approach</a></li>
                <li>
                    <a href="#top-down-approach" aria-label="Top-Down Approach">Top-Down Approach</a></li>
                <li>
                    <a href="#functionality-based-approach" aria-label="Functionality-Based Approach">Functionality-Based Approach</a></li></ul>
                </li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><img loading="lazy" src="https://cdn-images-1.medium.com/max/800/0*jDmBerRWYf3eZh2J" alt=""  />

<em><a href="https://images.pexels.com/photos/374559/pexels-photo-374559.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1">https://images.pexels.com/photos/374559/pexels-photo-374559.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1</a></em></p>
<h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p>Whitebox penetration testing can be intimidating. Complex web applications may contain hundreds of thousands of lines of code and deciphering the connection between the various web components and their numerous implementations is challenging. A powerful, yet simple technique to approach the code review of such an application is to break it into manageable pieces.</p>
<p>In this article, I will be outlining a methodology that can be used to break down large web applications, such as Content Management Systems (CMSs) into manageable components that can be systematically analyzed for vulnerabilities or logic errors. This is the approach that I used to discover CVE-2023–43154 and it is the approach taught in the AWAE, OffSec’s prerequisite course to the OffSec Web Expert (OSWE) certification.</p>
<p>Note that this article has an emphasis on web security, but the methodology can be applied to other fields of research as well.</p>
<p>Let’s begin.</p>
<h1 id="methodology">Methodology<a hidden class="anchor" aria-hidden="true" href="#methodology">#</a></h1>
<p>At a high level, this methodology begins with gaining familiarity with the application as a whole. This phase includes</p>
<ul>
<li>Identifying the technology stack — programming language, templating engine, database, etc..</li>
<li>Mapping out the application to gain a high-level overview of the structure of the project — commands like <code>tree -L 3</code> may be used.</li>
<li>Reading documentation</li>
<li>Understanding common use cases of the application</li>
<li>Exploring the application through its interface</li>
</ul>
<p>These steps help to develop a holistic understanding of the application. This enables you to better relate your subsequent findings to how the application is used, aiding in a more accurate assessment of impact and the likelihood of a successful exploit.</p>
<p>Then, the approach can branch into either of two directions: bottom-up or top-down. To understand what this means, it is first important to define what is meant by a “source” and a “sink”. From there, it will become more clear what is meant by the aforementioned approaches.</p>
<h2 id="sources-andsinks">Sources and Sinks<a hidden class="anchor" aria-hidden="true" href="#sources-andsinks">#</a></h2>
<p>Vulnerabilities in web applications commonly arise from the manner in which user input is handled. The entry point for user input is referred to as a source. An example of this would be input from a form, a query parameter in the URL, or a cookie. These are sources of user input that are then interpreted and handled by the web application.</p>
<p>A sink, on the contrary, is where the user input is actually used. This is where the vulnerability occurs. In the case of a SQL injection, the source may be a query parameter that has contents concatenated with a SQL query.</p>
<p>To further illustrate this point, I will provide an example. The vulnerable PHP code below has a source, <code>comment</code> , and a sink, <code>&lt;?php echo $_GET[‘comment’]; ?&gt;</code>. The lack of sanitization on the PHP code as it echos the user input results in an XSS vulnerability.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;!-- Source: https://example.com/?comment=&lt;script&gt;alert(1)&lt;/script&gt; --&gt;  
</span></span><span style="display:flex;"><span>&lt;div id=&#34;comment&#34;&gt;  
</span></span><span style="display:flex;"><span> &lt;!-- Sink --&gt;  
</span></span><span style="display:flex;"><span> &lt;?php echo $\_GET[&#39;comment&#39;]; ?&gt;   
</span></span><span style="display:flex;"><span>&lt;/div&gt;
</span></span></code></pre></div><p>For a more visual explanation, this <a href="https://youtu.be/ZaOtY4i5w_U?si=zXfJBsNlhp4h-CLa">LiveOverflow</a> video provides an excellent demonstration of the topic.</p>
<h2 id="bottom-up-approach">Bottom-Up Approach<a hidden class="anchor" aria-hidden="true" href="#bottom-up-approach">#</a></h2>
<p>The bottom-up approach refers to first locating sinks and tracing the code “upwards” to the source. For instance, I may search the code base for all occurrences of the sink <code>system()</code>, and from there follow the value that is passed into the function to search for any user input that may be implemented into that parameter.</p>
<p>Regular expressions are a common technique to speed up the process of finding sinks. Patterns such as <code>^.*unserialize\(.+\)</code> may be used to locate specific sinks (in this case, the <code>unserialize()</code> function) with more accuracy and can be used to narrow down the search effort. It is important to note, however, that this method has limitations. The regex results are only as strong as the pattern used and even well-established regular expressions can miss vulnerabilities and sinks.</p>
<p>This method is generally more tedious since not all occurrences of a sink will be used in the context of user-controlled data. Therefore, there can be more code to parse through in order to find a bug. Despite its repetitiveness, this approach has the advantage of increasing the likelihood of finding <strong>higher severity and less accessible vulnerabilities</strong> that are very difficult, if not impossible, to discover without access to the source code.</p>
<h2 id="top-down-approach">Top-Down Approach<a hidden class="anchor" aria-hidden="true" href="#top-down-approach">#</a></h2>
<p>On the contrary, the top-down approach consists of identifying sources and following their implementation in the code until a sink is found. For instance, I may submit the string <code>“test”</code> into a <code>EditProfile</code> functionality on a website. A top-down approach would consist of finding where the <code>“test”</code> string is received in the code and following the logic used on it until I locate its sink, or implementation, in a SQL query.</p>
<p>Regular expressions can be used here as well. A basic example is <code>^.*?query</code> to find query parameters. Regular expressions will typically become more complex depending on the specific context and the vulnerabilities that they are searching for.</p>
<p>This approach excels in finding vulnerabilities that are <strong>more accessible, but typically less severe</strong>. To clarify, high severity and high accessibility vulnerabilities can be discovered through either approach. One approach will simply increase your likelihood of finding a particular kind of vulnerability and the one that is chosen will depend on the individual priorities of the code review.</p>
<h2 id="functionality-based-approach">Functionality-Based Approach<a hidden class="anchor" aria-hidden="true" href="#functionality-based-approach">#</a></h2>
<p>A different perspective on code review is breaking the application down into sections based on functionality. Instead of starting broad with all of the application’s sources or sinks and then narrowing down into a vulnerable one, this approach involves starting narrow with one functionality and learning how it works on a deeper level in order to search for vulnerabilities in that particular segment of the application.</p>
<p>This approach is particularly useful when prioritizing certain types of vulnerabilities based on factors such as required authentication level. In this instance, one can curate a list of functionalities that can be used without authentication and analyze those for vulnerabilities. Prioritization is a useful tool when auditing large code bases to increase the chances of finding higher severity vulnerabilities or medium-low severity vulnerabilities that can more elegantly be chained together to result in a higher-severity attack.</p>
<h1 id="tooling"><img loading="lazy" src="https://cdn-images-1.medium.com/max/800/0*UPqLe8hb4dLd2h30" alt=""  />

Tooling</h1>
<p>I previously mentioned that searching through the code with regular expressions can be used to quickly identify sources and sinks. In addition to this, tools such as Semgrep can also be used to grep for certain patterns in the code. Semgrep looks at the code as more than a text file. It develops and abstract syntax tree (AST) in order to better understand the semantics. This can lead to its recognition of a certain vulnerable pattern in code that a regex pattern would miss. On the other hand, both are only as strong as the way they were written and they can lead to many false positives.</p>
<p>Static Application Security Testing (SAST) solutions can also aide in identifying vulnerabilities. <a href="https://spectralops.io/">SpectralOps</a>, Checkmarx, and Veracode are all examples of SAST tools used by organizations. I have not tried any of these at the time of writing, so I can not recommend one with certainty. SAST tools are generally meant for use by developers in the CI/CD pipeline, but they can also be used by researchers.</p>
<h1 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h1>
<p>The approach to static analysis that you use will impact the types of vulnerabilities that you are more likely and their likelihood of being exploitable. I encourage you to experiment with different approaches to static analysis and decide for yourself which methods work best for your goals. A mixed approach is quite common and even encouraged for best results.</p>
<p>Happy hacking!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ally-petitt.github.io/ally-petitt/en/en/tags/tutorial/">Tutorial</a></li>
      <li><a href="https://ally-petitt.github.io/ally-petitt/en/en/tags/security-research/">Security Research</a></li>
      <li><a href="https://ally-petitt.github.io/ally-petitt/en/en/tags/static-analysis/">Static Analysis</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://ally-petitt.github.io/ally-petitt/en/en/posts/2024-03-21_how-i-found-3-cves-in-2-days-8a135eb924d3/">
    <span class="title">« Prev</span>
    <br>
    <span>How I Found 3 CVEs in 2 Days</span>
  </a>
  <a class="next" href="https://ally-petitt.github.io/ally-petitt/en/en/posts/2023-12-02_stealthy-exploit-opens-door-for-pre-compilation-code-execution-17a57b9585cb/">
    <span class="title">Next »</span>
    <br>
    <span>Stealthy Exploit Opens Door for Pre-Compilation Code Execution</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Find more Vulnerabilities — Source Code Auditing Explained on x"
            href="https://x.com/intent/tweet/?text=How%20to%20Find%20more%20Vulnerabilities%e2%80%8a%e2%80%94%e2%80%8aSource%20Code%20Auditing%20Explained&amp;url=http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f&amp;hashtags=Tutorial%2cSecurityResearch%2cStaticAnalysis">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Find more Vulnerabilities — Source Code Auditing Explained on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f&amp;title=How%20to%20Find%20more%20Vulnerabilities%e2%80%8a%e2%80%94%e2%80%8aSource%20Code%20Auditing%20Explained&amp;summary=How%20to%20Find%20more%20Vulnerabilities%e2%80%8a%e2%80%94%e2%80%8aSource%20Code%20Auditing%20Explained&amp;source=http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Find more Vulnerabilities — Source Code Auditing Explained on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f&title=How%20to%20Find%20more%20Vulnerabilities%e2%80%8a%e2%80%94%e2%80%8aSource%20Code%20Auditing%20Explained">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Find more Vulnerabilities — Source Code Auditing Explained on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Find more Vulnerabilities — Source Code Auditing Explained on whatsapp"
            href="https://api.whatsapp.com/send?text=How%20to%20Find%20more%20Vulnerabilities%e2%80%8a%e2%80%94%e2%80%8aSource%20Code%20Auditing%20Explained%20-%20http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Find more Vulnerabilities — Source Code Auditing Explained on telegram"
            href="https://telegram.me/share/url?text=How%20to%20Find%20more%20Vulnerabilities%e2%80%8a%e2%80%94%e2%80%8aSource%20Code%20Auditing%20Explained&amp;url=http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to Find more Vulnerabilities — Source Code Auditing Explained on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=How%20to%20Find%20more%20Vulnerabilities%e2%80%8a%e2%80%94%e2%80%8aSource%20Code%20Auditing%20Explained&u=http%3a%2f%2flocalhost%3a1313%2fally-petitt%2fen%2fposts%2f2024-01-01_how-to-find-more-vulnerabilities---source-code-auditing-explained-2c8a10896374%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://ally-petitt.github.io/ally-petitt/en/en/">Ally Petitt</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
