<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Informative on Ally Petitt</title>
    <link>https://ally-petitt.com/tags/informative/</link>
    <description>Recent content in Informative on Ally Petitt</description>
    <generator>Hugo -- 0.125.4</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 02 Dec 2023 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://ally-petitt.com/tags/informative/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Stealthy Exploit Opens Door for Pre-Compilation Code Execution</title>
      <link>https://ally-petitt.com/posts/2023-12-02_stealthy-exploit-opens-door-for-pre-compilation-code-execution-17a57b9585cb/</link>
      <pubDate>Sat, 02 Dec 2023 00:00:00 +0000</pubDate>
      <guid>https://ally-petitt.com/posts/2023-12-02_stealthy-exploit-opens-door-for-pre-compilation-code-execution-17a57b9585cb/</guid>
      <description>&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*XwuUEqGz-1xT_v_j.jpg&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;&lt;a href=&#34;https://img.rasset.ie/001babea-1600.jpg&#34;&gt;https://img.rasset.ie/001babea-1600.jpg&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;introduction&#34;&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Linux users often take pride in their ability to compile their own code. In spite of this, a subtle yet critical attack vector has existed for over 20 years with high potential impact when exploited. Cleverly disguised within the &lt;code&gt;configure.ac&lt;/code&gt; file, this attack vector allows malicious actors to execute code on your system before the compilation process even begins.&lt;/p&gt;
&lt;p&gt;While the absence of known exploits may lull users into a false sense of security, it is precisely this lack of awareness that makes this attack vector dangerous, increasing the chances of successful and large-scale exploitation.&lt;/p&gt;
&lt;p&gt;The security concern that I am referring to is the ability to execute arbitrary code through &lt;code&gt;autoconf&lt;/code&gt;.&lt;/p&gt;
&lt;h1 id=&#34;what-is-autoconf&#34;&gt;What is Autoconf?&lt;/h1&gt;
&lt;p&gt;Traditionally, developers have used a &lt;a href=&#34;https://www.gnu.org/software/automake/manual/html_node/GNU-Build-System.html&#34;&gt;build system&lt;/a&gt; in order to distribute software packages that are easy for clients to compile. These build steps are specified in a Makefile.&lt;/p&gt;
&lt;p&gt;Different systems have different requirements. Sometimes, they require different flags to be set during compilation and sometimes the compiler is referred to by a different name. With such a diverse array of systems and configurations to cater to, Autoconf was offered as a solution.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*WhDuZ1uRN5oHHeR9&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;GNU Logo&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Autoconf is a crucial part of the GNU Autotools project and it ensures that packages are portable across different systems. It accomplishes this through macros from the M4 programming language to create a shell script that configures software source code packages for the respective system (see the &lt;a href=&#34;https://github.com/autotools-mirror/autoconf&#34;&gt;README&lt;/a&gt; for more information).&lt;/p&gt;
&lt;h1 id=&#34;how-does-autoconfwork&#34;&gt;How Does Autoconf Work?&lt;/h1&gt;
&lt;p&gt;Autoconf is one of the first commands executed when building a package that follows &lt;a href=&#34;https://www.gnu.org/prep/standards/standards.html&#34;&gt;GNU Coding Standards&lt;/a&gt; (which is a lot of packages). If not called directly, it is often included in an &lt;code&gt;autogen.sh&lt;/code&gt; script. The program uses instructions from a &lt;code&gt;configure.ac&lt;/code&gt; file to generate a dynamic &lt;code&gt;configure&lt;/code&gt;bash script that is responsible for matching the libraries on the system to those required in the program.&lt;/p&gt;
&lt;h1 id=&#34;the-securityconcern&#34;&gt;The Security Concern&lt;/h1&gt;
&lt;p&gt;Because Autoconf interprets user-controlled input through the &lt;code&gt;configure.ac&lt;/code&gt; file, it is possible to insert malicious code that gets executed upon the running the generated &lt;code&gt;configure&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;Furthermore, and increasingly concerning, is the possibility of obtaining code execution upon execution of the &lt;code&gt;autoconf&lt;/code&gt; command- before the generated &lt;code&gt;configure&lt;/code&gt; file is even ran. This means one less step in order to pwn a computer.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*Hgtdvi95rRshZbBM.png&#34; alt=&#34;&#34;  /&gt;

For example, hackers can embed a malicious payload within the &lt;code&gt;configure.ac&lt;/code&gt; file and when an unsuspecting Linux user begins building the package, the attacker-controlled code would be executed on the system.&lt;/p&gt;
&lt;p&gt;This can be abused to perform targeted cyberattacks on developers, general Linux users, security researchers, and more if the supply chain is compromised. Additionally, because this is not well-known, modern code-scanning and SAST solutions often fail to include checks for malicious code within &lt;code&gt;configure.ac&lt;/code&gt;, decreasing the chance of detection.&lt;/p&gt;
&lt;p&gt;I discuss exactly how to exploit this in my &lt;a href=&#34;https://github.com/ally-petitt/autoconf-code-execution&#34;&gt;Proof-of-Concept&lt;/a&gt; on GitHub, which was published after receiving permission from the Autoconf maintainers to publicly disclose my concerns.&lt;/p&gt;
&lt;h1 id=&#34;how-hard-was-this-tofind&#34;&gt;How Hard Was This To Find?&lt;/h1&gt;
&lt;p&gt;I want to briefly explain the ease with which I was able to uncover this potentially dangerous functionality. First, I identified the programming language being used was M4, so I read &lt;a href=&#34;https://mbreen.com/m4.html&#34;&gt;core notes&lt;/a&gt; for approximately 30 minutes to get a high-level overview of the language.&lt;/p&gt;
&lt;p&gt;After experimenting with the functionality and realizing that it was possible to embed bash code in the created &lt;code&gt;configure&lt;/code&gt; script, I wondered if I could take it a step further and get code execution from running &lt;code&gt;autoconf&lt;/code&gt; alone.&lt;/p&gt;
&lt;p&gt;Within 2 hours of combing through the source code to learn how the application works, I identified 3 potential locations for code to be executed. I then created a &lt;a href=&#34;https://github.com/ally-petitt/autoconf-code-execution&#34;&gt;PoC&lt;/a&gt; to submit in a bug report to the Autoconf maintainers.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*H4i_I34WTV0KbZE5&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;&lt;a href=&#34;https://seeklogo.com/images/M/m4-logo-88B85DB5FB-seeklogo.com.png&#34;&gt;https://seeklogo.com/images/M/m4-logo-88B85DB5FB-seeklogo.com.png&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;My findings were low-hanging fruits and I suspect they have only gone this long without being abused because of the learning curve to understand M4. As you will see in the next segment, I am far from the first to know of this functionality.&lt;/p&gt;
&lt;h1 id=&#34;autoconfs-response&#34;&gt;Autoconf’s Response&lt;/h1&gt;
&lt;p&gt;Since 2/3 of my concerns came from a segment of legacy code that has been unused since the year 2000, one of the maintainers removed the macro in &lt;a href=&#34;https://git.savannah.gnu.org/cgit/autoconf.git/commit/?id=11d8824daada20055c855f46ad7c45237c1ff455&#34;&gt;this commit&lt;/a&gt; and thanked me for bringing the unused code snippets to their attention.&lt;/p&gt;
&lt;p&gt;They explained to me that there were plenty of opportunities to execute code when using Autoconf and that the ability to invoke macros such as &lt;code&gt;m4_syscmd&lt;/code&gt;, allowing for code execution, was a conscious design decision as many of their users rely on that functionality. In fact, it is common for &lt;code&gt;m4_syscmd&lt;/code&gt; to be used to run commands such as &lt;code&gt;git describe&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Another of the points in my PoC was that they included a macro that executed the &lt;code&gt;cat&lt;/code&gt; command without an absolute path. This made the program vulnerable to the modification of a $PATH environmental variable which could lead to execute arbitrary code execution and privilege escalation under the correct circumstances.&lt;/p&gt;
&lt;p&gt;The maintainers explained that adding an absolute path to the binary would break Nix, Guix, and more. They made the assumption that Autoconf is being run in an environment with a secure $PATH within a sandbox, which is consistent with best practices. However, I have strong doubts that the majority of users actually follow these precautions.&lt;/p&gt;
&lt;h1 id=&#34;implications&#34;&gt;Implications&lt;/h1&gt;
&lt;p&gt;I want to be clear that I respect the maintainers and the effort and time they have put into creating a tool that we have all benefited from. The ability to execute OS commands is not inherently dangerous, but when abused it can certainly have security implications.&lt;/p&gt;
&lt;p&gt;Given the reliance on &lt;code&gt;m4_syscmd&lt;/code&gt; by Autoconf’s clientele, it is clear to me that the maintainers have no plans of removing the functionality. The ability to execute arbitrary code upon running &lt;code&gt;autoconf&lt;/code&gt; will remain in the foreseeable future, making it an even more attractive attack vector for adversaries.&lt;/p&gt;
&lt;p&gt;In fact, the manner in which this functionality is built-in is reminiscent of attack techniques displayed in &lt;a href=&#34;https://gtfobins.github.io/&#34;&gt;GTFObins&lt;/a&gt;, which are often used for privilege escalation.&lt;/p&gt;
&lt;h1 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;The ability to run commands from Autoconf is a feature, not a bug. However, it is a feature that can be abused in a way that very few people are aware of. And when exploited strategically, this can lead to the infection or damage of thousands of devices.&lt;/p&gt;
&lt;p&gt;I hope that in writing this, I was able to bring awareness to open-source users on the potential dangers of configuring untrusted applications. If you have any questions, concerns, or criticisms on this article, feel free to message me on &lt;a href=&#34;https://www.linkedin.com/in/ally-petitt/&#34;&gt;LinkedIn&lt;/a&gt; and I will be happy to discuss them with you.&lt;/p&gt;
&lt;p&gt;Thanks for reading!&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Beyond the Screen: The Hidden World of Firmware Security</title>
      <link>https://ally-petitt.com/posts/2023-08-05_beyond-the-screen--the-hidden-world-of-firmware-security-87b0ea6a20a4/</link>
      <pubDate>Sat, 05 Aug 2023 00:00:00 +0000</pubDate>
      <guid>https://ally-petitt.com/posts/2023-08-05_beyond-the-screen--the-hidden-world-of-firmware-security-87b0ea6a20a4/</guid>
      <description>&lt;h1 id=&#34;introduction&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/1*UA4-sPgJH7Fhk9jbvvRafQ.jpeg&#34; alt=&#34;https://www.istockphoto.com/photo/man-using-laptop-with-update-software-computer-program-upgrade-business-technology-gm1449779856-486876929&#34;  /&gt;

Introduction&lt;/h1&gt;
&lt;p&gt;Firmware is a critical component of electronic devices. It is the program that is installed on embedded systems that defines their functionality. Firmware is responsible for initializing the hardware components as the computer boots up, enabling the device to function properly.&lt;/p&gt;
&lt;p&gt;Attacks against firmware have been of increasing interest to hackers due to their relative ease to exploit in a world of increasingly more secure application- and network-layer security practices. Firmware security has been a frequently overlooked attack surface in cybersecurity that is now relatively unprotected in comparison to other attack vectors such as web applications or operating systems.&lt;/p&gt;
&lt;p&gt;In addition, security mitigations such as performing firmware updates are often more costly and inconvenient as they may require updating other software and firmware dependencies on the system, leading to more downtime. In some environments such as hospitals, firmware must pass very strict regulations which can increase the time it takes for updates. Compatibility between the firmware and hardware can result in an additional barrier for firmware updates.&lt;/p&gt;
&lt;h1 id=&#34;the-rise-of-firmwareattacks&#34;&gt;The Rise of Firmware Attacks&lt;/h1&gt;
&lt;p&gt;Firmware attacks are quickly becoming more common. According to &lt;a href=&#34;https://www.microsoft.com/en-us/security/blog/2021/03/30/new-security-signals-study-shows-firmware-attacks-on-the-rise-heres-how-microsoft-is-working-to-help-eliminate-this-entire-class-of-threats/&#34;&gt;Microsoft&lt;/a&gt;, 80% of organizations between the years 2019 and 2021 were victims to at least 1 firmware attack. In many cases, firmware is a single point of failure in the devices of organizations. The privileged nature of firmware allows for it to be abused by cybercriminals to access information such as cryptographic keys in memory, the BIOS/UEFI memory, network traffic, and potentially data from peripheral devices such as SSDs or webcams.&lt;/p&gt;
&lt;p&gt;These are some of the techniques used by adversaries once they have obtained firmware-level access:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Disable security settings such as Secure Boot (&lt;a href=&#34;https://thehackernews.com/2023/03/blacklotus-becomes-first-uefi-bootkit.html&#34;&gt;BlackLotus&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Modify the boot record of the system to contain a bootkit&lt;/li&gt;
&lt;li&gt;Wipe the boot record resulting in a bricked system&lt;/li&gt;
&lt;li&gt;Arbitrarily read secrets and other sensitive data from memory&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;attack-surface&#34;&gt;Attack Surface&lt;/h1&gt;
&lt;p&gt;Attacking firmware can lead to extremely privileged access to a system. For instance, Baseboard Management Controllers (BMCs), Unified Extensible Firmware Interface (UEFI), System Management Mode (SMMs), or management subsystems on the CPU can each be compromised. This section will outline each component’s purpose, security risk, and mitigation techniques.&lt;/p&gt;
&lt;h2 id=&#34;bmcs&#34;&gt;BMCs&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*9hEnbp2Z7WCO9WKV&#34; alt=&#34;&#34;  /&gt;

Baseboard Management Controllers (BMCs) are hardware components that are often soldered into the motherboard of enterprise-grade servers. They may be assigned different names depending on the model that is used. For instance, Dell’s high end PowerEdge servers refer to the BMC as iDRAC (Dell Remote Access Controller) and HP has their infamous iLO (integrated Lights Out) which, as the name implies, provides out-of-band remote management services for the server that allow it to run in a lights out data center with minimal physical interaction.&lt;/p&gt;
&lt;p&gt;The role of BMCs is to allow remote management of the server. This includes power management, which is the ability to turn the server off and on, and the ability to configure UEFI settings. They often include a built-in keyboard video mouse (KVM) functionality that allows out-of-band access to the display of the server and allows for direct interaction with it through a keyboard and mouse.&lt;/p&gt;
&lt;p&gt;BMCs are highly privileged components that may be abused for&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Data theft and exfiltration&lt;/li&gt;
&lt;li&gt;Malware installation&lt;/li&gt;
&lt;li&gt;Disabling security features such as Secure Boot&lt;/li&gt;
&lt;li&gt;Physical damage to the system caused by sending it a signal that increases the voltage to the CPU causing it to overheat&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Another attack might include incessant rebooting of the system, rendering it temporarily useless and leading to a loss of availability.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Mitigation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;BMC attacks can be mitigated through the following techniques:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Establishing unique user accounts (if possible) and setting a strong password- ideally one that is in line with &lt;a href=&#34;https://pages.nist.gov/800-63-3/sp800-63b.html&#34;&gt;NIST’s password guidelines&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Enforcing secure network practices such as not exposing the BMC to the internet and implementing VLAN separation&lt;/li&gt;
&lt;li&gt;Use firmware scanning tools to verify the integrity of the firmware and catch security misconfigurations&lt;/li&gt;
&lt;li&gt;Monitoring BMC integrity through an established root of trust (RoT) such as a TPM or secure enclave in the CPU&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;uefibios&#34;&gt;UEFI/BIOS&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*B3RibWe5mxvLNeKh&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;Picture of a BIOS screen&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The Unified Extensible Firmware Interface (UEFI) is the modern and prevalent successor to the Basic Input Output System (BIOS).&lt;/p&gt;
&lt;p&gt;With access to the UEFI, attackers can&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Wipe the UEFI — the resulting hardware would need to be sent back to the hardware to be flashed with the correct firmware again&lt;/li&gt;
&lt;li&gt;Firmware modification&lt;/li&gt;
&lt;li&gt;Bootkit installation&lt;/li&gt;
&lt;li&gt;Physical damage to the system&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;An infamous example of malware that attacks the UEFI is &lt;a href=&#34;https://thehackernews.com/2023/03/blacklotus-becomes-first-uefi-bootkit.html&#34;&gt;BlackLotus&lt;/a&gt;, a bootkit that abused &lt;a href=&#34;https://github.com/Wack0/CVE-2022-21894&#34;&gt;CVE-2022–21894&lt;/a&gt; to truncate the SecureBoot policy from memory via the Windows Boot Application, thereby fully bypassing the security measure. Malware with the level of access granted by the UEFI can result in expensive damages to enterprise systems.&lt;/p&gt;
&lt;h2 id=&#34;smms&#34;&gt;SMMs&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*J6wRzq-WjDenWZ3v.png&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;&lt;a href=&#34;https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2020/11/SMM-social-2.png&#34;&gt;https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2020/11/SMM-social-2.png&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The System Management Mode (&lt;a href=&#34;https://en.wikipedia.org/wiki/System_Management_Mode&#34;&gt;SMM&lt;/a&gt;) is a highly privileged operating mode that is often referred to as Ring -2. The primary benefit of SMM is that it offers a distinct processor environment that is meant for use by only the UEFI/BIOS. The SMM code is executed in its own isolated address space known as SMRAM that is inaccessible to other privilege levels. This isolation is enforced by firmware.&lt;/p&gt;
&lt;p&gt;When System Manager Interrupts (SMIs) are issued during runtime, they interrupt the current execution of the CPU and transfer control to the SMI Handler, which is a software routine stored in the firmware that is responsible for handling and processing these interrupts. SMIs are how the UEFI interacts with the SMM.&lt;/p&gt;
&lt;p&gt;SMMs can be abused to&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Implant rootkits and bootkits on a system&lt;/li&gt;
&lt;li&gt;Read sensitive data&lt;/li&gt;
&lt;li&gt;Maintain persistence and stealth&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Mitigation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Mitigations for SMM attacks can include keeping the firmware updated and using security mechanisms such as Data Execution Prevention (DEP) and Control-Flow Integrity (CFI) on compiled binaries to protect from memory-based attacks.&lt;/p&gt;
&lt;h2 id=&#34;management-subsystems&#34;&gt;Management Subsystems&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*5XuFmJUmVLjZnmpG&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;&lt;a href=&#34;https://freundschafter.com/wp-content/uploads/2018/01/7254-f-4-bc8a6355cce759c3.png&#34;&gt;https://freundschafter.com/wp-content/uploads/2018/01/7254-f-4-bc8a6355cce759c3.png&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Intel’s &lt;a href=&#34;https://en.wikipedia.org/wiki/Intel_Management_Engine&#34;&gt;Management Engine&lt;/a&gt; (ME) or AMD’s &lt;a href=&#34;https://en.wikipedia.org/wiki/AMD_Secure_Technology&#34;&gt;Platform Security Processor&lt;/a&gt; (PSP) are standalone microcontroller components that allow for out-of-band, remote management of a computer. They are included in the chipsets of these CPUs and, as explained in &lt;a href=&#34;https://freundschafter.com/research/about-intel-management-engine-intel-me-intel-active-management-technlogy-iamt/&#34;&gt;this article&lt;/a&gt;, the ME of an Intel chip in particular has a separated connection from the internal Interconnect, means it has the capabilities to bypass other subsystems like TPM and SMBus.&lt;/p&gt;
&lt;p&gt;The ME contains the Intel Active Management Technology (AMT). The AMT provides the remote management and control capabilities for Intel-based computers and servers, even when the system is powered off or the operating system is not running. It is a service that is enabled by the hardware microcontroller that is referred to as the ME.&lt;/p&gt;
&lt;p&gt;Despite ME and BMCs having a similar functionality, BMCs are not implemented into the same variety and scale of devices as the management engine is. This can significantly increase the impact of an ME vulnerability.&lt;/p&gt;
&lt;p&gt;Well known vulnerabilities in the ME include &lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2018-3627&#34;&gt;CVE-2018–3627&lt;/a&gt; and &lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2020-8703&#34;&gt;CVE-2020–8703&lt;/a&gt; which can lead to arbitrary code execution and local privilege escalation respectively.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Mitigation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Keeping the software of the CPU updated is crucial for mitigation. The updates can contain patches for known security vulnerabilities on the ME of the chip. In particular, updating the CSME, AMT, I ISM, DAL and DAL Software can prevent vulnerabilities as well as securely configuring the management engine if possible.&lt;/p&gt;
&lt;h1 id=&#34;supply-chainattacks&#34;&gt;Supply Chain Attacks&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/1*3iEBRxmvxyY1JJnKj1V-Yw.png&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;&lt;a href=&#34;https://www.enisa.europa.eu/news/enisa-news/understanding-the-increase-in-supply-chain-security-attacks/@@download/image/IncidentReporting-PR_423x300mm_01.png&#34;&gt;https://www.enisa.europa.eu/news/enisa-news/understanding-the-increase-in-supply-chain-security-attacks/@@download/image/IncidentReporting-PR_423x300mm_01.png&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Attacking the supply chain can involve tampering with the firmware or hardware at any stage in the supply chain including development, manufacturing, distribution, and updating or patching the system. The result can be widely distributed malware affecting countless systems.&lt;/p&gt;
&lt;p&gt;In addition to the aforementioned tampering, firmware often uses 3rd-party dependencies (e.g. &lt;a href=&#34;https://binarly.io/posts/OpenSSL_Usage_in_UEFI_Firmware_Exposes_Weakness_in_SBOMs/index.html&#34;&gt;OpenSSL&lt;/a&gt;) which can remain outdated even when included in the latest firmware version. The result is a discrepancy between the firmware and its dependencies which never received an update, despite having critical security vulnerabilities.&lt;/p&gt;
&lt;p&gt;One method used to manage supply chain dependencies is using a Software Bill of Materials (SBOM). This is a list of the software components that are implemented into a firmware component. The accuracy and integrity of these lists are crucial to ensure that the known vulnerabilities in the firmware’s dependencies can be identified. There are also commercial solutions that monitor the firmware’s activity and integrity in order to raise alerts when suspicious hallmarks of infected firmware are detected.&lt;/p&gt;
&lt;h1 id=&#34;malware-attacks&#34;&gt;Malware Attacks&lt;/h1&gt;
&lt;p&gt;Another way that firmware can be exploited is through a system that has already been infected. This may happen through social engineering, executing a malicious program, exploiting vulnerabilities in externally facing service, drive-by attacks, and other initial access methods identified by the &lt;a href=&#34;https://attack.mitre.org/&#34;&gt;MITRE ATT&amp;amp;CK framework&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With this attack type, the malicious actor or malware will attempt to elevate their privileges to the highest possible level and use tools such as &lt;a href=&#34;http://rweverything.com/&#34;&gt;RWEverything&lt;/a&gt; to write to the drivers and firmware. Through this approach, attackers are still able to obtain the privileged access of and stealth granted through firmware-level access.&lt;/p&gt;
&lt;h1 id=&#34;firmware-attacks-in-thewild&#34;&gt;Firmware Attacks in the Wild&lt;/h1&gt;
&lt;p&gt;It has become increasingly more prevalent for adversaries to gain their initial foothold on a network through remote access products. In 2020 alone, &lt;a href=&#34;https://www.checkpoint.com/downloads/resources/cyber-security-report-2021.pdf&#34;&gt;Checkpoint’s annual&lt;/a&gt; cybersecurity report found a substantial increases ranging from 85% to 2,066% of attacks that exploit vulnerabilities in these products as shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/1*Mx8XRA2YeI3His7r24yFuQ.png&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;Page 25 of Checkpoint’s 2021 cybersecurity report&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Many of these vulnerabilities are caused by insecure firmware. Examples of this in insecure VPN products are &lt;a href=&#34;https://www.bleepingcomputer.com/news/security/zyxel-warns-of-critical-vulnerabilities-in-firewall-and-vpn-devices/&#34;&gt;Zyxel&lt;/a&gt;’s &lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2023-33009&#34;&gt;CVE-2023–33009&lt;/a&gt; and &lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2023-33010&#34;&gt;CVE-2023–33010&lt;/a&gt; and Fortinet’s &lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2023-27997&#34;&gt;CVE-2023–27997&lt;/a&gt;. Both are critical RCEs caused by a buffer overflow that can lead to unauthorized, highly privileged access to a device. This can then be abused to implant malware such as a bootkit or make other critical configuration changes to the system and to move laterally through the internal network.&lt;/p&gt;
&lt;h1 id=&#34;mitigations&#34;&gt;Mitigations&lt;/h1&gt;
&lt;h2 id=&#34;security-platforms&#34;&gt;Security Platforms&lt;/h2&gt;
&lt;p&gt;Firmware security platforms such as those offered by &lt;a href=&#34;https://binarly.io/&#34;&gt;Binarly&lt;/a&gt; and &lt;a href=&#34;https://eclypsium.com/&#34;&gt;Eclypsium&lt;/a&gt; can help to detect and mitigate firmware misconfigurations and vulnerabilities. Binarly relies primarily on AI and deep code inspection to detect known and unknown vulnerabilities and misconfigurations in firmware. Eclypsium’s approach appears to incorporate both crytographic and heuristic verification of firmware with continuous monitoring, although the exact approach of both of these solutions is unknown.&lt;/p&gt;
&lt;p&gt;In addition, Lenovo launched their &lt;a href=&#34;https://techtoday.lenovo.com/us/en/solutions/thinkshield&#34;&gt;ThinkShield&lt;/a&gt; earlier this week, which is also powered by Eclypsium. A testament to the increase in availability of commercial solutions in firmware and supply chain security.&lt;/p&gt;
&lt;h2 id=&#34;code-signing&#34;&gt;Code Signing&lt;/h2&gt;
&lt;p&gt;Solutions that use cryptographic signatures to verify the integrity of code can also be used to mitigate supply chain attacks. Unforeseen malware being added to production code, for instance, can be prevented since the changes after the program was signed would be easier to detect.&lt;/p&gt;
&lt;p&gt;For instance, &lt;a href=&#34;https://www.sigstore.dev&#34;&gt;Sigstore&lt;/a&gt; is an open source project that at a high level uses Public Key Infrastructure (PKI) in order to validate the integrity of different modules in the supply chain to ensure that they were not tampered with. It does this by using a Sigstore client such as Cosign to request a public and private key from the certificate authority Fulcio. The private key that was obtained is used with Cosign to sign the file or image to be verified. After the artifact is signed, the signature of the file, its digest, and public key are stored in Rekor, an append-only transparency ledger that is viewable by the public. The private key is then deleted automatically, removing the need for key management. This system allows for developers, security professionals, and end users to verify that the file they have has not been tampered with.&lt;/p&gt;
&lt;p&gt;It is worth noting, however, that while code signing will verify integrity, it does not guarantee that the Software Bill of Materials (SBOM) is fully accurate in its content and completeness in closed-source projects. The security implication is potential lack of transparency on 3rd-party dependencies in these projects leading to unpatched security vulnerabilities in the system.&lt;/p&gt;
&lt;h1 id=&#34;initiatives&#34;&gt;Initiatives&lt;/h1&gt;
&lt;p&gt;While firmware attacks are on the rise, there is hope to be found in the initiatives that have been enacted in order to fortify this section of cybersecurity.&lt;/p&gt;
&lt;h2 id=&#34;increased-firmware-publications&#34;&gt;Increased Firmware Publications&lt;/h2&gt;
&lt;p&gt;There has been a rising awareness of firmware security that can be attributed largely to the increased amount of publications in circulation. These may include security best practices, vulnerability disclosures, or news articles.&lt;/p&gt;
&lt;p&gt;In June of this year, the Cybersecurity &amp;amp; Infrastructure Security Agency (CISA) and the National Security Agency (NSA) collaborated to create a guide for &lt;a href=&#34;https://media.defense.gov/2023/Jun/14/2003241405/-1/-1/0/CSI_HARDEN_BMCS.PDF&#34;&gt;hardening baseboard management controllers&lt;/a&gt;. This document outlined best practices for securing BMCs including many of the techniques that were mentioned previously in this article.&lt;/p&gt;
&lt;h2 id=&#34;ssith&#34;&gt;SSITH&lt;/h2&gt;
&lt;p&gt;In 2017, Defense Advanced Research Projects Agency (DARPA) created their System Security Integration Through Hardware and Firmware (&lt;a href=&#34;https://www.darpa.mil/program/ssith&#34;&gt;SSITH&lt;/a&gt;) program which takes a proactive approach to low-level security.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;SSITH is focusing specifically on common classes of hardware weaknesses as identified by the MITRE Common Weakness Enumeration Specification (CWE) and NIST, including buffer errors; information leakage; resource management; numeric errors; injection; permissions, privileges, and access control; and hardware/system-on-chip implementation errors. Researchers are exploring a number of different approaches that go well beyond patching. These include using metadata tagging to detect unauthorized system access; utilizing context sensing pipelines to determine the intent of instructions; and employing formal methods to reason about integrated circuit systems and guarantee the accuracy of security characteristics.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.darpa.mil/program/ssith&#34;&gt;Dr. Lok Yan&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Although it does have a predominant focus on hardware, SSITH still recognizes the role of firmware as an essential component in addressing security challenges and preventing exploit.&lt;/p&gt;
&lt;p&gt;SSITH appears to be an ongoing program whose effects have not yet been released publicly.&lt;/p&gt;
&lt;h2 id=&#34;secure-development-practices&#34;&gt;Secure Development Practices&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://cdn-images-1.medium.com/max/800/0*h4xdnj8S3XpVFr8o.jpg&#34; alt=&#34;&#34;  /&gt;

&lt;em&gt;&lt;a href=&#34;https://blog.gitguardian.com/content/images/2022/05/21W10-blog-content-stateOfReport-image2.jpg&#34;&gt;https://blog.gitguardian.com/content/images/2022/05/21W10-blog-content-stateOfReport-image2.jpg&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Cybersecurity has gradually become a significant part of the development process of both software and firmware. More companies are making the shift to a Secure Software Development Lifecycle (SSDLC). With this model, security is a consideration from the conception of a program to its release.&lt;/p&gt;
&lt;h1 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;With firmware attacks on the rise and an increased reliance on digital devices, securing systems is an important step of preventing critical cyberattacks. Modern commercial solutions can help to monitor firmware configurations, activity, and supply chain vulnerabilities and the trend towards secure development and education can help to decrease the amount of vulnerabilities that are in the firmware to begin with. In spite of this, firmware will likely never reach a point of having zero vulnerabilities. Maintaining regular updates and continuous education on the latest research is imperative in safeguarding our digital ecosystems, fortifying devices against emerging threats, and fostering a resilient foundation for a secure and trustworthy technological future.&lt;/p&gt;
</description>
    </item>
  </channel>
</rss>
